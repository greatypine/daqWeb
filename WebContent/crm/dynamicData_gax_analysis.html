<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>国安侠毛利</title>
    <link rel="shortcut icon" type="image/x-icon" href="../icon.png" />
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=0.3, maximum-scale=1, user-scalable=yes" name="viewport">  <!-- Bootstrap 3.3.6 -->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="bootstrap/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="bootstrap/css/ionicons.min.css">
    <!-- Morris charts -->
    <link rel="stylesheet" href="plugins/morris/morris.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
         folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">
    <link rel="stylesheet" href="plugins/daterangepicker/daterangepicker-bs3.css">
    <!-- Select2 -->
    <link rel="stylesheet" href="plugins/select2/select2.min.css">
    <link href="../scripts/css/auto.css" rel="stylesheet">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="IE 9/html5shiv.min.js"></script>
    <script src="IE 9/respond.min.js"></script>
    <![endif]-->
    <style>
        .box-default{border-bottom: 1px solid #e1e1e1;}
        .info_head{padding: 25px 0 35px 0;}
        .info_head img{width:123px; margin-top:10px;}
        .info_head span{padding-left: 20px;}
        .info_bottom{padding: 35px 20px 0 35px; font-size: 12px;}
        .info_bottom .text-right span{padding: 6px 12px; margin:0 20px 0 3px; display: inline-block;}
        .box .h4{padding-left:20px;}
        .nav-tabs-custom{padding:0 20px;}
        .nav-tabs{border:0;}
        .logo-lg li{float: left; position: relative;}

        .logo-lg i{color: #fff;}
        .nav_dropdown{ position: absolute;z-index: 10000; top: 70px; left: -10px; line-height: 22px; padding: 15px 25px; background-color: #15b092; display: none;}
        .nav_dropdown li{padding: 5px 0; line-height: 20px; white-space: nowrap; font-size: 14px;}
        .logo-lg > ul > li:hover > a{color: #001f3f; font-weight: bold;}
        .logo-lg > ul > li:hover i{ transform: rotate(180deg); transition: all 0.3s linear; color: #001f3f;}


        .tcdPageCode{padding: 15px 20px;text-align: left;color: #ccc;text-align:center;}
        .tcdPageCode a{display: inline-block;color: #428bca;display: inline-block;height: 25px;	line-height: 25px;	padding: 0 10px;border: 1px solid #ddd;	margin: 0 2px;border-radius: 4px;vertical-align: middle;}
        .tcdPageCode a:hover{text-decoration: none;border: 1px solid #428bca;}
        .tcdPageCode span.current{display: inline-block;height: 25px;line-height: 25px;padding: 0 10px;margin: 0 2px;color: #fff;background-color: #428bca;	border: 1px solid #428bca;border-radius: 4px;vertical-align: middle;}
        .tcdPageCode span.disabled{	display: inline-block;height: 25px;line-height: 25px;padding: 0 10px;margin: 0 2px;	color: #bfbfbf;background: #f2f2f2;border: 1px solid #bfbfbf;border-radius: 4px;vertical-align: middle;}

        #process_div{
            background-color:#292a2b;
            display:inline;
            z-index:100000;
            left:0px;
            opacity:0.3; top:0; left:0;height:100%; width:100%; z-index:999; position:fixed; _position:absolute; _left: expression_r(documentElement.scrollLeft + documentElement.clientWidth - this.offsetWidth); _top: expression_r(documentElement.scrollTop + documentElement.clientHeight - this.offsetHeight);
            filter:Alpha(Opacity=30);
            opacity: 0.3;
        }

        #process_div_pic{
            position:fixed;
            top:50%;
            left:50%;
            z-index:100000000;
            margin:-16px 0 0 -50px;
            width:100px;
            height:32px;
            color: #fff;
        }
        /*搜索框*/
        .form-control{height: 30px; line-height: 30px; border-radius: 6px; padding: 3px 8px;}
    </style>
</head>
<body class="hold-transition skin-blue sidebar-mini">
<div id="process_div" style="display:none"></div>
<div id="process_div_pic" style="display:none"><img style="width:50px;height: 50px;" src="dist/img/376884043677306248.png"><i class="fa fa-refresh fa-spin"></i></div>
<!-- Site wrapper -->
<div class="wrapper">




    <header class="main-header">
        <nav class="navbar navbar-static-top">
            <div class="container">
                <div class="logo_img pull-left">
                    <img src="dist/img/logo.png" height="30">
                    <img src="dist/img/title.png" height="20">
                </div>
                <div class="pull-left">
                    <div class="logo-lg">
                        <ul class="no-margin">
                            <li class="current"><em>国安侠毛利</em></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!--     <header class="main-header">
            <nav class="navbar navbar-static-top">
                <div class="container">
                    <div class="pull-left">
                        <nav class="navbar navbar-static-top no-margin">
                            <div class="logo-lg clearfix">
                                <div class="logo-lg clearfix">
                                    <ul>
                                        <li><a href="javascript:parent.location.reload();" class="h2"> <img src="dist/img/logo.png"> </a></li>
                                        <li class="nav-mark"><a href="#">片区GMV</a> </li>
                                        <li></li>
                                    </ul>
                                </div>
                            </div>
                        </nav>
                    </div>
                </div>
            </nav>
        </header> -->


    <!-- =============================================== -->

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <div class="container" style="width:1230px">
            <!-- Main content -->

            <section class="content-header">
                <div class="box box-default">
                    <div class="box-header h4 text-light-blue">
                        <div class="pull-left "><strong>国安侠毛利</strong></div>
                        <div class="pull-left text-red" style="padding-left:15px;font-size:75%">数据口径：</div>
                        <div class="pull-left text-red" style="font-size:75%">1.销售收入=片区销售收入+手动匹配营销收入+人均匹配营销收入</br>2.片区销售收入：当月所有指定国安侠的有效订单收入（去除退货）</br>3.手动匹配营销收入：当月所有手动分配的有效订单收入（去除退货）</br>4.人均匹配营销收入：当月门店内现场扫码类订单收入均值</br>5.片区营销费用：指定国安侠类订单内平台分摊使用的优惠券</br>6.手动匹配营销费用：手动匹配类订单内平台分摊使用的优惠券</br>7.毛利=片区销售收入+手动分配销售收入+人均分配销售收入-片区营销费用-手动分配营销费用-报损盘亏。</div>
                    </div>
                    <div class="box-body">
                        <div class="form-group col-lg-4">
                            <label>查询时间</label>
                            <!--<div class="input-group">-->
                            <!--<div class="input-group-addon">-->
                            <!--<i class="fa fa-calendar"></i>-->
                            <!--</div>-->
                            <!--<input type="text" class="form-control pull-right" id="be_date1">-->
                            <!--</div>-->
                            <!-- /.input group -->
                            <!--                             <select class="form-control select2" id="be_date1" style="border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3);"> -->
                            <!--                                 <option value="prev_month" >上月</option> -->
                            <!--                                 <option value="cur_month" selected>本月（截止到昨天24点）</option> -->
                            <!--                             </select> -->
                            <input type="text" class="form-control" id="be_date1" name="be_date1" readonly="readonly" style="cursor:pointer;background-color:#ffffff"></input>
                        </div>
                        <div class="form-group col-lg-4">
                            <label>城市</label>
                            <!--                             <input id="city_id_customer" name="city_id_customer" type="hidden" bidTableFlag="true" value=""/> -->
                            <!--                             <input id="city_name_customer" name="city_name_customer" maxlength="40" type="text" class="form-control" bidTableFlag="true" list="city_name-search_customer" style="display: inherit;width: 90%;border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3);"/> -->
                            <!--                             <datalist id="city_name-search_customer"> -->
                            <!--                                                                     <option value="1"> -->
                            <!--                                                                     <option value="2"> -->
                            <!--                             </datalist> -->
                            <input id="city_id_customer" name="city_id_customer" type="hidden" value=""/>
                            <input type="text" class="form-control"  placeholder="城市" id="city_name_customer" style="display: inherit;width: 90%;border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3)"/>
                            <div class="auto hidden" id="auto_city" style="width:82%;z-index: 99999;">
                                <!-- /.input group -->
                            </div>
                            <!-- /.input group -->
                        </div>
                        <div class="form-group col-lg-4">
                            <label>门店</label>
                            <!--                             <input id="store_id_customer" name="store_id_customer" type="hidden" bidTableFlag="true" value=""/> -->
                            <!--                             <input id="store_name_customer" name="store_name_customer" maxlength="40" type="text" class="form-control" bidTableFlag="true" list="store_name-search_customer" style="display: inherit;width: 90%;border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3);"/> -->
                            <!--                             <datalist id="store_name-search_customer"> -->
                            <!--                                                                     <option value="1"> -->
                            <!--                                                                     <option value="2"> -->
                            <!--                             </datalist> -->
                            <input id="store_id_customer" name="store_id_customer" type="hidden" value=""/>
                            <input type="text" class="form-control"  placeholder="门店" id="store_name_customer" style="border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3);width: 90%""/>
                            <div class="auto hidden" id="auto_store" style="width:82%;z-index: 99999;">
                            </div>
                            <!-- /.input group -->
                        </div>
                        <div class="form-group col-lg-4">
                            <label>员工姓名</label>
                            <input id="employee_name" name="employee_name" type="text" class="form-control" bidTableFlag="true" style="display: inherit;width: 90%;border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3);" value=""/>
                        </div>
                        <div class="form-group col-lg-4">
                            <label>员工编号</label>
                            <input id="employee_no" name="employee_no" type="text" class="form-control" bidTableFlag="true" style="display: inherit;width: 90%;border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3);" value=""/>
                        </div>
                        <div class="form-group col-lg-6" style="margin-top: 20px; padding: 0 25px;">
                        </div>
                        <div class="form-group col-lg-2" style="margin-top: 20px; padding: 0 25px;">
                            <button type="button" class="btn btn-block btn-primary" onclick="search_customer(1)">查询</button>
                        </div>
                        <div class="col-lg-2" style="margin-top: 20px; padding: 0 25px;">
                            <button type="button" onclick="export_gaxmaoli()" class="btn btn-block btn-warning">导出</button>
                        </div>
                        <div class="col-lg-2" style="margin-top: 20px; padding: 0 25px;">
                            <button type="button" onclick="resetSerachParam()" style="border-color:#00a65a;background-color:#00a652;color:white" class="btn btn-block">重置</button>
                        </div>
                    </div>
                    <div class="box-body">
                        <div class="nav-tabs-custom">
                            <div class="tab-content">
                                <div>
                                    <table class="table table-striped">
                                        <tbody id="customer_tbody">
                                        <tr>
                                            <th width="8%" style="font-size: 14px;font-weight: bold;">城市</th>
                                            <th width="8%" style="font-size: 14px;font-weight:bold;">门店名称</th>
                                            <th width="8%" style="font-size: 14px;font-weight:bold;">门店编码</th>
                                            <th width="8%" style="font-size: 14px;font-weight:bold;">员工姓名</th>
                                            <th width="8%" style="font-size: 14px;font-weight:bold;">员工编号</th>
                                            <th width="8%" style="font-size: 14px;font-weight:bold;"><font id="columnattention" style="color:#337ab7;font-size:14px;font-weight:normal;">！</font>
                                                <font id="forcolumnattention" style="color:#47b8ef;font-size: 12px;white-space: nowrap;position: absolute;top:-8px;z-index: 1000;display:none;left:17px">片区销售收入+手动分配销售收入-人均分配销售收入</font>销售收入</th>
                                            <th width="8%" style="font-size: 14px;font-weight:bold;" id="areain">片区销售收入<br/></th>
                                            <th width="8%" style="font-size: 14px;font-weight:bold;" id="handin">手动分配销售收入<br/></th>
                                            <th width="8%" style="font-size: 14px;font-weight:bold;" id="avgin">人均分配销售收入<br/></th>
                                            <th width="8%" style="font-size: 14px;font-weight:bold;" >营销费用<br/></th>
                                            <th width="6%" style="font-size: 14px;font-weight:bold;">报损盘亏<br/></th>
                                            <th width="10%" style="font-size: 14px;font-weight:bold;"><font id="columnattention1" style="color:#337ab7;font-size:14px;font-weight:normal;">！</font>
                                                <font id="forcolumnattention1" style="color:#47b8ef;font-size: 12px;white-space: nowrap;position: absolute;top:-8px;z-index: 1000;display:none;left:17px">销售收入-营销费用-报损盘亏</font>毛利</th>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="tcdPageCode" id="page_customer"></div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

<!-- ./wrapper -->
<!-- jQuery 2.2.0 -->
<script src="plugins/jQuery/jQuery-2.2.0.min.js"></script>
<script type="text/javascript" src="laydate/laydate.js"></script>
<!-- Bootstrap 3.3.6 -->
<script src="bootstrap/js/bootstrap.min.js"></script>
<!-- Morris.js charts -->
<script src="bootstrap/js/raphael-min.js"></script>
<script src="plugins/morris/morris.min.js"></script>
<!-- FastClick -->
<script src="plugins/fastclick/fastclick.js"></script>
<!-- AdminLTE App -->
<script src="dist/js/app.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="dist/js/demo.js"></script>

<!-- page script -->
<script type="text/javascript" src="plugins/jquery.page.js"></script>
<script type="text/javascript" src="plugins/moment.min.js"></script>
<script src="plugins/daterangepicker/daterangepicker.js"></script>

<script type="text/javascript" src="../scripts/bidLibjsjquery3.0.js"></script>
<script type="text/javascript" src="../scripts/auto.js"></script>
<script type="text/javascript">
    layer.config({

        extend: 'skin/crmskin/style.css' //加载新皮肤

    });
    var cur_date = new Date();
    var now_month =cur_date.getMonth();
    var max_year = cur_date.getFullYear();
    var now_date =cur_date.getDate();
    var max_month = "";
    var use_month = max_year+"-"+(now_month+1)+"-"+now_date;
    if(now_month>0&&now_month<10){
        max_month = "0"+now_month;
        if(now_month<9){
            now_month ="0"+(now_month+1);
        }else{
            now_month = now_month+1;
        }
    }else{
        if(now_month==0){
            max_year =cur_date.getFullYear()-1;
            max_month = "12";
            now_month = now_month+1;
        }else{
            max_month = now_month;
            now_month = now_month+1;
        }

    }
    var year_month = max_year+"-"+max_month;
    var max_date = "";
    var max_month1 =max_month;
    var max_month =max_year+"-"+max_month +"-"+(cur_date.getDate());
    if(now_date==1){
        if(now_month==4||now_month==6||now_month==9||now_month==11){
            now_date =30;
        }else
        if(max_year%4==0&&now_month==2){
            now_date=29;
        }else{
            now_date=31;
        }
        if(max_month=="12"){
            max_date = max_year+"-"+now_month +"-"+now_date;

        }else{
            max_date = cur_date.getFullYear()+"-"+now_month +"-"+now_date;
        }
    }else{
        max_date = cur_date.getFullYear()+"-"+now_month +"-"+(now_date-1);
    }
    laydate.render({//月份控件
        elem:'#be_date1',
        value:year_month,
        type:"month",
        btns: ['confirm'],
        theme: '#11214e',
        min: '2018-10-1',
        max:use_month,

    });
    var cityId = decode64(getUrlParamByKey("c"));//城市ID
    var cityName = decode64(getUrlParamByKey("cn"));//城市名称
    var employeeId = decode64(getUrlParamByKey("e"));//员工编号/id
    var storeId = decode64(getUrlParamByKey("s"));//门店编号
    var target = decode64(getUrlParamByKey("t"));//职务
    var storeName=decode64(getUrlParamByKey("sn"));//门店名
    var storeNo=decode64(getUrlParamByKey("so"));//门店编号
    var role = decode64(getUrlParamByKey("r"));
    var initCity = cityId;
    $(function () {
        if(target==0){//总部

        }else if(target==1){//城市
            $("#city_name_customer").val(cityName);
            $("#city_name_customer").attr("readonly",true);
        }else if(target==2){//店长
            $("#city_name_customer").val(cityName);
            $("#city_name_customer").attr("readonly",true);
            $("#store_name_customer").val(storeName);
            $("#store_name_customer").attr("readonly",true);
        }
        /* if(target==1){
            $("#store_name_customer").attr("readonly",true);
        } */
        $(".logo-lg > ul > li").hover(function(){
            $(this).children(".nav_dropdown").toggle('1000');
        });
        $("#columnattention").on("mouseover",function(event){
            $("#forcolumnattention").show();
        });
        $("#columnattention").on("mouseout",function(event){
            $("#forcolumnattention").hide();
        });
        $("#columnattention1").on("mouseover",function(event){
            $("#forcolumnattention1").show();
        });
        $("#columnattention1").on("mouseout",function(event){
            $("#forcolumnattention1").hide();
        });
        //Date range picker
//    $('#be_date1').daterangepicker();
    });

    /**-----------------------------------搜索城市------------------------------------------------------**/
    var lst_select_city=null;
    var cityNameArray=new Array();
    var cityIdMap = {};
    $('#city_name_customer').keyup(function(event){//门店交易额统计
        cityNameArray=new Array();
        $('#auto_city').empty();
        $("#auto_store").empty();
        $("#store_id_customer").val("");
        $("#store_name_customer").val("");
        //$('#store_name-search_customer').children().remove();
        var str_name = $(this).val();
        if(!(event.keyCode >= 37 && event.keyCode <= 40) && event.keyCode != 13){
            $("#city_id_customer").val("");
            $('#city_name-search_customer').children().remove();
            if(str_name == null || str_name == "" || str_name.indexOf('\'') > -1){
                return;
            }
            var city_id = null;
            if(target==1){
                city_id = cityId;

            }
            doManager('dynamicManager','selectAllCity',null,function(data){
                if(data.result){

                    lst_select_city = JSON.parse(data.data);
//                       $(lst_select_city).each(function(index,element){
//                           $('#city_name-search_customer').append('<option value="'+element.cityname+'">');
//                       });
                    for(i=0;i<lst_select_city.length;i++){
                        cityNameArray.push(lst_select_city[i].cityname);
                        cityIdMap[lst_select_city[i].cityname] = lst_select_city[i].id;
                    }
                    var autoComplete = new AutoComplete("city_name_customer","auto_city",cityNameArray);
                    autoComplete.start(event);
                }else{

                }
            });
        }
    });


    $('#auto_city').on("click",function(){
        var temp_city = document.getElementById("city_name_customer").value.replace(/(\s*)|(\s*)/g,'').replace(/[ ]/g,'');
        $("#city_id_customer").val(cityIdMap[temp_city]);
    });
    //        $('#city_name_customer').change(function(){

    //            $(lst_select_city).each(function(index,element){
    //               if(element.cityname == $('#city_name_customer').val()){

    //                   $('#city_id_customer').val(element.id);
    //                   return;
    //               }
    //            });
    //       });


    /**-----------------------------------搜索门店------------------------------------------------------**/
    var lst_select_store=null;
    var storeNameArray=new Array();
    var storeIdMap = {};
    $('#store_name_customer').keyup(function(event){
        $("#auto_store").empty();
        storeNameArray=new Array();
        var str_name = $(this).val();
        if(!(event.keyCode >= 37 && event.keyCode <= 40) && event.keyCode != 13){
            $("#store_id_customer").val("");
            //$('#store_name-search_customer').children().remove();
            if(str_name == null || str_name == "" || str_name.indexOf('\'') > -1){
                return;
            }
            var city_id = null;
            if(target==0){//总部
                city_id = ($("#city_id_customer").val())==""?null:($("#city_id_customer").val());
                var city_name = $("#city_name_customer").val();
                if(city_id==null&&city_name!=""){
                    city_id=-10000;
                }
            }else if(target==1){//城市
                city_id = initCity;
            }
            doManager('dynamicManager','getStoreByCity',[target,employeeId,city_id,str_name],function(data){
                if(data.result){
                    lst_select_store = JSON.parse(data.data).storelist;
                    for(i=0;i<lst_select_store.length;i++){
                        storeNameArray.push(lst_select_store[i].name);
                        storeIdMap[lst_select_store[i].name] = lst_select_store[i].store_id;
                    }
                    var autoComplete = new AutoComplete("store_name_customer","auto_store",storeNameArray);
                    autoComplete.start(event);
                }else{

                }
            });
        }
    });

    $('#auto_store').on("click",function(){
        var temp_store = document.getElementById("store_name_customer").value.replace(/(\s*)|(\s*)/g,'').replace(/[ ]/g,'');
        $("#store_id_customer").val(storeIdMap[temp_store]);
    });


    <!-------------------------------------------------------点击查询----------------------------------------------------------------->

    var isCreatePage=false;
    function search_customer(cur_page){

        isCreatePage=false;
        var begin_end_date = $("#be_date1").val();
        if(begin_end_date==""){
            crm_alert(0,"请选择时间！");
            return;
        }


        search_customer1(cur_page,begin_end_date);

    }

    //查询上
    var currentPage= 1;
    var totalPage = 1;
    function   search_customer1(cur_page,begin_end_date){

        $("#process_div").show();
        $("#process_div_pic").show();
        var number_str = $("#store_id_customer").val();
        var storeName = $("#store_name_customer").val();
        if(number_str==""&&storeName!=""){
            number_str=-10000;
        }
        var dynamicDto=null;
        var employeeNo=$("#employee_no").val();
        var employeeName = $("#employee_name").val();
        if(target==0){
            var cityId = $("#city_id_customer").val();
            var cityName = $("#city_name_customer").val();
            if(cityId==""&&cityName!=""){
                cityId="-10000";
            }
            dynamicDto = {
                beginDate:begin_end_date,
                storeNumer:number_str,
                cityId:cityId,
                cityName:cityName,
                employeeId:employeeId,
                storeId:number_str,
                target:target,
                employeeNo:employeeNo,
                employeeName:employeeName
            }
        }else  if(target==1){
            var cityId = $("#city_id_customer").val();
            var cityName = $("#city_name_customer").val();
            dynamicDto = {
                beginDate:begin_end_date,
                storeNumer:number_str,
                cityId:initCity,
                cityName:cityName,
                employeeId:employeeId,
                storeId:number_str,
                target:target,
                employeeNo:employeeNo,
                employeeName:employeeName
            }
        }else if(target==2){
            dynamicDto = {
                beginDate:begin_end_date,
                storeNumer:number_str,
                employeeNo:employeeId,
                storeId:storeId,
                target:target,
                employeeNo:employeeNo,
                employeeName:employeeName
            }
        }
        var pageInfo = new Object();
        pageInfo.currentPage = cur_page;
        doManager('dynamicManager','employeeOfMaoli',[dynamicDto,pageInfo],function(data){
            if(data.result){
                var result= JSON.parse(data.data);
                if(result.status=='success'){
                    $("#customer_tbody").find("tr:gt(0)").remove();
//	        	   var jData = JSON.parse(result.data).data;
                    var jData = result.maoli;
                    if(jData==null||jData.length==0){

                        crm_alert(5,"没有符合条件的数据！");
                        $("#page_customer").createPage({
                            pageCount:0,
                            current:0,
                            backFn:function(p){

                            }
                        });
                        $("#process_div").hide();
                        $("#process_div_pic").hide();
                        return;
                    }
                    totalPage_customer =result.total_pages;
                    if(!isCreatePage){
                        $("#page_customer").createPage({
                            pageCount:totalPage_customer,
                            current:1,
                            backFn:function(p){
                                search_customer1(p,begin_end_date);
                            }
                        });
                        isCreatePage=true;
                    }

                    var infoStr="";
                    for(var i=0;i<jData.length;i++){
                        if("2018-10"==begin_end_date){
                            infoStr= "<tr>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].city_name+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].store_name+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].storeno+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].employee_name+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].employee_no+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].income+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;display: none'>0</td>"
                                +"<td style='font-size: 14px;font-weight: normal;display: none'>0</td>"
                                +"<td style='font-size: 14px;font-weight: normal;display: none'>0</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].sumprice+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].baosun+"</td>"
                               /* +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].pankui+"</td>"*/
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].maoli+"</td>"
                                +"</tr>";

                        }else{
                            infoStr= "<tr>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].city_name+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].store_name+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].storeno+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].employee_name+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].employee_no+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].allcome+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].income+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].outcome+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].wcd_profit+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].sumprice+"</td>"
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].baosun+"</td>"
                               /* +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].pankui+"</td>"*/
                                +"<td style='font-size: 14px;font-weight: normal;'>"+jData[i].maoli+"</td>"
                                +"</tr>";

                        }

                        $("#customer_tbody").append(infoStr);
                    }
                    if("2018-10"==begin_end_date){
                         $("#areain").hide();
                         $("#handin").hide();
                         $("#avgin").hide();
                    }else{
                        $("#areain").show();
                        $("#handin").show();
                        $("#avgin").show();
                    }
                }else{
                    crm_alert(5,JSON.parse(result.data).message);
                    $("#customer_tbody").find("tr:gt(0)").remove();
                    $("#page_customer").createPage({
                        pageCount:0,
                        current:0,
                        backFn:function(p){

                        }
                    });
                    $("#process_div").hide();
                    $("#process_div_pic").hide();
                    return;
                }
            }else{
                crm_alert(5,"请稍后重新请求！");
            }
            $("#process_div").hide();
            $("#process_div_pic").hide();
        });

    }

    //导出 片区GMV
    function   export_gaxmaoli(){
        var begin_end_date = $("#be_date1").val();
        if(begin_end_date==""){
            crm_alert(0,"请选择时间！");
            return;
        }
//    	crm_alert(0,"由于是实时数据，导出结果和当前展示数据有差异，请注意！");
        $("#process_div").show();
        $("#process_div_pic").show();

        var number_str = $("#store_id_customer").val();
        var storeName = $("#store_name_customer").val();
        if(number_str==""&&storeName!=""){
            number_str=-10000;
        }
        var dynamicDto=null;
        var employeeNo=$("#employee_no").val();
        var employeeName = $("#employee_name").val();
        if(target==0){
            var cityId = $("#city_id_customer").val();
            var cityName = $("#city_name_customer").val();
            if(cityId==""&&cityName!=""){
                cityId="-10000";
            }
            dynamicDto = {
                beginDate:begin_end_date,
                storeNumer:number_str,
                cityId:cityId,
                cityName:cityName,
                employeeId:employeeId,
                storeId:number_str,
                target:target,
                employeeNo:employeeNo,
                employeeName:employeeName
            }
        }else if(target==1){
            var cityId = $("#city_id_customer").val();
            var cityName = $("#city_name_customer").val();
            dynamicDto = {
                beginDate:begin_end_date,
                storeNumer:number_str,
                interfaceType:'customerPortrait',
                cityId:initCity,
                cityName:cityName,
                employeeId:employeeId,
                storeId:number_str,
                target:target,
                employeeNo:employeeNo,
                employeeName:employeeName
            }
        }else if(target==2){
            dynamicDto = {
                beginDate:begin_end_date,
                storeNumer:number_str,
                interfaceType:'customerPortrait',
                employeeNo:employeeId,
                storeId:storeId,
                target:target,
                employeeNo:employeeNo,
                employeeName:employeeName
            }
        }
        doManager('dynamicManager','exportEmployeeOfMaoli',[dynamicDto],function(data){
            if(data.result){
                var result= JSON.parse(data.data);
                if(result.status=='success'){
                    window.location.href=result.data;
                }else if(result.status=="null"){
                    crm_alert(0,"请先确认是否有符合条件的数据，重新请求！");
                    $("#process_div").hide();
                    $("#process_div_pic").hide();
                    return;
                }else{
                    crm_alert(5,"请稍后重新请求！");
                    $("#process_div").hide();
                    $("#process_div_pic").hide();
                    return;
                }

            }else{
                crm_alert(5,"请稍后重新请求！");
            }
            $("#process_div").hide();
            $("#process_div_pic").hide();
        });
    }





    function resetSerachParam(){
        $("#auto_store").empty();
        laydate.render({//月份控件
            elem:'#be_date1',
            value:year_month,
            type:"month",
            btns: ['confirm'],
            theme: '#11214e',
            min: '2018-10-1',
            max:max_month,

        });
        if(target==0){//总部
            $("#store_id_customer").val("");
            $("#store_name_customer").val("");
            $("#store_name-search_customer").empty();

            $("#city_id_customer").val("");
            $("#city_name-search_customer").empty();
            $("#city_name_customer").val("");
            $("#employee_no").val("");
            $("#employee_name").val("");
        }else if(target==1){//城市级别

            $("#store_id_customer").val("");
            $("#store_name_customer").val("");
            $("#store_name-search_customer").empty();
            $("#employee_no").val("");
            $("#employee_name").val("");

        }else if(target==2){//店长
            $("#employee_no").val("");
            $("#employee_name").val("");
        }
    }
</script>

</body>
</html>