<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>合作社社员统计</title>
    <link rel="shortcut icon" type="image/x-icon" href="../icon.png" />
  <!-- Tell the browser to be responsive to screen width -->
<meta content="width=device-width, initial-scale=0.3, maximum-scale=1, user-scalable=yes" name="viewport">  <!-- Bootstrap 3.3.6 -->
  <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="bootstrap/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="bootstrap/css/ionicons.min.css">
  <!-- Morris charts -->
  <link rel="stylesheet" href="plugins/morris/morris.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
  <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">
  <link rel="stylesheet" href="plugins/daterangepicker/daterangepicker-bs3.css">
  <!-- Select2 -->
  <link rel="stylesheet" href="plugins/select2/select2.min.css">
  <link rel="stylesheet" href="plugins/date-new/css/jquery-ui-1.9.2.custom.css" type="text/css">
  <link href="../scripts/css/auto.css" rel="stylesheet">
  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="IE 9/html5shiv.min.js"></script>
  <script src="IE 9/respond.min.js"></script>
  <![endif]-->
  <style>
    .box-default{border-bottom: 1px solid #e1e1e1;height:100%; width:100%;}
    .info_head{padding: 25px 0 35px 0;}
    .info_head img{width:123px; margin-top:10px;}
    .info_head span{padding-left: 20px;}
    .info_bottom{padding: 35px 20px 0 35px; font-size: 12px;}
    .info_bottom .text-right span{padding: 6px 12px; margin:0 20px 0 3px; display: inline-block;}
    .box .h4{padding-left:20px;}
    .nav-tabs-custom > .nav-tabs > li.active{border-top-color:#3c8dbc!important}
	.nav-tabs-custom > .nav-tabs > li.active > a{background-color:#fff;color:#000;}
    .logo-lg li{float: left; position: relative;}

    .logo-lg i{color: #fff;}
    .nav_dropdown{ position: absolute;z-index: 10000; top: 70px; left: -10px; line-height: 22px; padding: 15px 25px; background-color: #15b092; display: none;}
    .nav_dropdown li{padding: 5px 0; line-height: 20px; white-space: nowrap; font-size: 14px;}
    .logo-lg > ul > li:hover > a{color: #001f3f; font-weight: bold;}
    .logo-lg > ul > li:hover i{ transform: rotate(180deg); transition: all 0.3s linear; color: #001f3f;}
    .table button{padding: 3px 20px; margin: 0 5px;}
	.table a{color:#194dc4;}
    
    
    .tcdPageCode{padding: 15px 20px;text-align: left;color: #ccc;text-align:center;}
	.tcdPageCode a{display: inline-block;color: #428bca;display: inline-block;height: 25px;	line-height: 25px;	padding: 0 10px;border: 1px solid #ddd;	margin: 0 2px;border-radius: 4px;vertical-align: middle;}
	.tcdPageCode a:hover{text-decoration: none;border: 1px solid #428bca;}
	.tcdPageCode span.current{display: inline-block;height: 25px;line-height: 25px;padding: 0 10px;margin: 0 2px;color: #fff;background-color: #428bca;	border: 1px solid #428bca;border-radius: 4px;vertical-align: middle;}
	.tcdPageCode span.disabled{	display: inline-block;height: 25px;line-height: 25px;padding: 0 10px;margin: 0 2px;	color: #bfbfbf;background: #f2f2f2;border: 1px solid #bfbfbf;border-radius: 4px;vertical-align: middle;}
 
	 #process_div{ 
			background-color:#292a2b; 
			display:inline; 
			z-index:100000;  
			left:0px; 
			opacity:0.3; top:0; left:0;height:100%; width:100%; z-index:999; position:fixed; _position:absolute; _left: expression_r(documentElement.scrollLeft + documentElement.clientWidth - this.offsetWidth); _top: expression_r(documentElement.scrollTop + documentElement.clientHeight - this.offsetHeight);
			filter:Alpha(Opacity=30); 
			opacity: 0.3; 
		} 
		
		#process_div_pic{
			position:fixed;
			top:50%;
			left:50%; 
			z-index:100000000; 
			margin:-16px 0 0 -50px; 
			width:100px; 
			height:32px;
			color: #fff;
		}
		
		/*搜索框*/
    .form-control{height: 30px; line-height: 30px; border-radius: 6px; padding: 3px 8px;}
    small span:hover{
    	color:#337ab7;
    	}
    	
    	
    	
    /*时间控件*/
    .show-more-line{width: 100%; height: 40px; border-top: 1px dashed #e6e6e6; position: relative; background-color: #f5f5f5;}
    .how-more{position: absolute; top: -1px; left: 50%; background-color: #fff; border-left: 1px solid #e6e6e6; border-right: 1px solid #e6e6e6; border-bottom: 1px solid #e6e6e6;  padding: 5px 15px; margin: 0 0 0 -40px; color: #888; cursor: pointer; font-size: 12px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}
    .how-more i{padding-left: 5px; font-size: 14px;}
    .fold-con,.sl-btns{display: none;}
    .selectorLine{border-top: 1px dashed #e6e6e6; padding: 10px 0 0 0; position: relative;}
    .selectorLine a{float: left; height: 18px; line-height: 18px; padding: 0 3px; margin: 2px 12px 12px 0; white-space: nowrap;}
    .selectorLine a:nth-child(1){margin-left: 15px;}
    .selectorLine a:hover{background-color: #ff7701; color: #fff;}
    .search-title{width: 100px; color: #777; white-space: nowrap; overflow: hidden; position: absolute; top: 10px; left: 0; text-align: right;}
    .search-con{margin-left: 0px; padding-right: 80px; overflow: hidden;}
    .sl-ext {position: absolute; top: 10px; right: 10px; width: 60px; height: auto; line-height: 22px; overflow: hidden; zoom: 1;}
    .search-more{width: 60px; height: 25px; line-height: 25px; padding: 0 7px 0 0; background: #fff; color: #333; border: 1px solid #ddd; font-size: 12px; position: relative; right: 0; top: 0;}
    .search-more i{position: absolute; top: 3px; right: 0; display: block; width: 20px; height: 20px; background-position: 4px 7px; font-size: 18px;}
    .search-more:hover{color: #e4393c;}
    .search-more-open i{ -webkit-transform: rotateX(180deg); -o-transform: rotateX(180deg); -moz-transform: rotateX(180deg);}
    .sx_type{margin-top: 5px;}
    .sx_type span{padding-right: 5px;}
    .sx_type span .icheckbox_minimal-blue{margin-right: 2px;}

    
    
    
    /*类型*/
    .leixing div{display: inline-block; position: relative; cursor: pointer;}
    .type_con{width: 65px; height: 45px; line-height: 45px; color: #fff; display: block; position: absolute; bottom: 20px; left: -20px; display: none;}
    .gonghai .type_con{background: url("dist/img/gonghai(1).png") no-repeat; background-size: 100% 100%;}
    .yichang .type_con{background: url("dist/img/gonghai(2).png") no-repeat; background-size: 100% 100%;}
    .gonghai:hover .type_con,.yichang:hover .type_con{display: block;}
    .fold-con{display: none;}
    .auto{max-height:200px; overflow-y:scroll;}
    .opeDiv span{float: right;width: 46px;height: 24px;line-height: 24px;text-align: center;font-size: 12px;border: 1px solid #9fa3a8;border-radius: 3px;color: #616d73;margin: 0 13px 12px 0;box-shadow: 0 1px 5px rgba(0,0,0,0.3);cursor: pointer;}
	.Confirm{ background: linear-gradient(#83c56a, #63b254); border: 1px solid #46975d!important;; color: #fff!important;}
	.ui-close-date{color: #fff; font-size: 14px!important; float:right!important; margin-right:10px!important}
	.ui-datepicker-quick span{height: 30px; line-height: 35px}
	.ui-datepicker-time{background-color:transparent}
  </style>
</head>
<body class="hold-transition skin-blue sidebar-mini">
<div id="process_div" style="display:none"></div>
<div id="process_div_pic" style="display:none"><img style="width:50px;height: 50px;" src="dist/img/376884043677306248.png"><i class="fa fa-refresh fa-spin"></i></div>
<!-- Site wrapper -->
<div class="wrapper">


 <header class="main-header">
    <nav class="navbar navbar-static-top">
      <div class="container">
					<div class="logo_img pull-left">
						<img src="dist/img/logo.png" height="30">
						<img src="dist/img/title.png" height="20">
					</div>
					<div class="pull-left">
						<div class="logo-lg">
							<ul class="no-margin">
								<li class="current"><em>合作社社员统计</em></li>
							</ul>
						</div>
					</div>
      </div>
    </nav>
  </header>


  <!-- =============================================== -->

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <div>
      <!-- Main content -->

      <section class="content-header">
        <div class="nav-tabs-custom no-margin">
          <ul class="nav nav-tabs">
			  <li class="active" id="tab_2_avtive"><a href="#tab_2" id="bigshow2" data-toggle="tab" aria-expanded="false">城市单位统计</a></li>
			  <li id="tab_1_avtive"><a href="#tab_1" id="bigshow1" data-toggle="tab" aria-expanded="true">门店单位统计</a></li>
			  <li class="" id="tab_3_avtive"><a href="#tab_3" id="bighide" data-toggle="tab" aria-expanded="false">试用社员统计</a></li>

		  </ul>
		  <div class="tab-content">
			  <div class="col-sm-12 text-right text-red no-padding" style="padding-left:15px;font-size:75%;float: right">
				  <p >统计数据每10分钟更新一次</p>
			  </div>
			  <div class="tab-pane" id="tab_1">
	          <div class="box-body">
	          <div class="clearfix search-criteria">
	            <div id="selectorLine clearfix no-border" class="clearfix">
	            <div class="form-group col-lg-4">
	              <label>开卡时间</label>
	             	<div class="search-con">
						<div class="time" style="width: 325px;z-index: 99999;margin:0 15px 0 0;">
						    <div class="time_endbg" id="time_endbg">
						        <p>日期选择：<span class="data_choice" id="data_choice">默认时期</span></p>
						        <input type="text" class="ui-datepicker-time" id="searchTime" readonly value=""/>
						    </div>
						</div>
						<div class="ui-datepicker-css" id="ui-datepicker-css" style="margin:0 15px 0 0;">	
						    <div class="ui-datepicker-quick" id="ui-datepicker-quick">
						        <input class="ui-date-quick-button" type="button" value="今天" alt="0"  name=""/>
						        <input class="ui-date-quick-button" type="button" value="昨天" alt="-1" name=""/>
						        <input class="ui-date-quick-button" type="button" value="7天内" alt="-6" name=""/>
						        <input class="ui-date-quick-button" type="button" value="30天内" alt="-29" name=""/>
						        <input class="ui-date-quick-button" type="button" value="60天内" alt="-59" name=""/>
						        <input class="ui-date-quick-button" type="button" value="全部" alt="1" name="">
						        <span class="ui-close-date" id="ui-close-date" style="cursor:pointer;">X</span>
						    </div>
						    <div class="ui-datepicker-choose">
						        <!--<p>自选日期</p>-->
						        <div class="ui-datepicker-date">
							       	<input name="startDate" id="startOpenCardDate" class="startDate" readonly value="2018/05/21" type="text">
							           到
						            <input name="endDate" id="endOpenCardDate" class="endDate" readonly  value="2018/05/21" type="text" disabled>
						        </div>
						        <div class="opeDiv">
									<span class="Cancel" id="Cancel">取消</span>
						            <span class="Confirm" id="Confirm" onclick="datePickersOpenCard()">确定</span>
						        </div>
						    </div>
						</div>
					</div>
	            </div>
	            <div class="form-group col-lg-4">
	              <label>城市</label>
				  <input id="city_id_tradetype" name="city_id_tradetype" type="hidden" value=""/>
				  <input type="text" class="form-control"  placeholder="城市" id="city_name_tradetype" style="display: inherit;width: 90%;border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3)"/>
	              <div class="auto hidden" id="auto_city" style="width:85%;z-index: 99999;">
	              <!-- /.input group -->
	              </div>
	            </div>
	            <div class="form-group col-lg-4">
	              <label>门店</label>
				  <input id="store_id_tradetype" name="store_id_tradetype" type="hidden" value=""/>
				  <input type="text" class="form-control"  placeholder="门店" id="store_name_tradetype" style="border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3);width: 90%"/>
	              <div class="auto hidden" id="auto_store" style="width:85%;z-index: 99999;">
	              </div>
	              <!-- /.input group -->
	            </div>
	            </div>
	            </div>
	            
	            <div class="clearfix">
	            	<div class="form-group col-lg-2 pull-right" style="margin-top: 20px; padding: 0 25px;">
		                <button type="button" onclick="resetSerachParam()" style="border-color:#00a65a;background-color:#00a652;color:white" class="btn btn-block">重置</button>
		            </div>
		            <div class="form-group col-lg-2 pull-right" style="margin-top: 20px; padding: 0 25px;">
		              <button type="button" onclick="export_tradetype()" class="btn btn-block btn-warning">导出</button>
		            </div>
		            <div class="form-group col-lg-2 pull-right" style="margin-top: 20px; padding: 0 25px;">
		              <button type="button" class="btn btn-block btn-primary" onclick="searchInfo_tradetype_step1(1)">查询</button>
		            </div>
		            
	            </div>
	
	          </div>
	          <div class="box-body">
	              <div class="tab-content">
	                <div>
	                  <table class="table table-striped">
	                    <tbody id="tradeType_tbody">
		                    <tr>
							  <th width="8%">城市</th>
							  <th width="10%">门店名称</th>
							  <th width="10%">门店编号</th>
							  <th>安心存</th>
							  <th>淘金汇</th>
							  <th>畅购卡升级</th>
							  <th>兑换码</th>
							  <th width="12%">199付费社员数</th>
							  <th>其他</th>
							  <th width="12%">
								新增社员数
								<font id="showattention" style="color:#ffcc00;font-size:14px;font-weight:normal;">！</font>
								<font id="attention" style="color:#47b8ef;font-size: 12px;white-space: nowrap;position: absolute;top:-15px;z-index: 1000;display:none;left:-10px">查询时间段内新增社员总数</font>
							  </th>
							  <th width="12%">
								  累计社员总数
								  <label style="font-weight:normal;" id="query_store_info"></label>
							  </th>
		                    </tr>
	                    </tbody>
	                  </table>
	                </div>
	                <!-- /.tab-pane -->
	              </div>
	              <!-- /.tab-content -->
				  <div style="position:absolute;bottom:20px;left:27px;width:25%">显示 <select id="pageRecords_store" name="pageRecords_store" onchange="chnagePageRecords_Store(2)"  style="height:25px;line-height:25px;border-radius:4px;"><option value="10" selected="selected">10</option><option value="50">50</option><option value="100">100</option></select> 条 &nbsp;&nbsp; 共  <span id="totalRecord_store"></span> 条</div>
				  <div class="tcdPageCode" id="page_tradetype"></div>
	          </div>
	        </div>
	        
	        <div class="tab-pane active" id="tab_2">
	          <div class="box-body">
	          <div class="clearfix search-criteria">
	            <div id="selectorLine clearfix no-border" class="clearfix">
	            <div class="form-group col-lg-4">
	              <label>开卡时间</label>
	             	<div class="search-con">
							<div class="time" id="time_flag" style="width: 325px;z-index: 99999;margin:0 15px 0 0;">
							    <div class="time_endbg" id="first_time_endbg">
							        <p>日期选择：<span class="data_choice" id="first_data_choice">默认时期</span></p>
							        <input type="text" class="ui-datepicker-time" id="first_date" readonly="" value="">
							    </div>
							</div>
							<div class="ui-datepicker-css" id="first-ui-datepicker-css" style="margin: 0px 15px 0 0; display: none;">
							    <div class="ui-datepicker-quick" id="first-ui-datepicker-quick">
 							        <input class="ui-date-quick-button" type="button" value="今天" alt="0"  name=""/> 
							        <input class="ui-date-quick-button" type="button" value="昨天" alt="-1" name="">
							        <input class="ui-date-quick-button" type="button" value="7天内" alt="-6" name="">
							        <input class="ui-date-quick-button" type="button" value="30天内" alt="-29" name="">
							        <input class="ui-date-quick-button" type="button" value="60天内" alt="-59" name="">
							        <input class="ui-date-quick-button" type="button" value="全部" alt="1" name="">
							        <span class="ui-close-date" id="first-ui-close-date" style="cursor:pointer;">X</span>
							    </div>
							    <div class="ui-datepicker-choose">
							        <!--<p>自选日期</p>-->
							        <div class="ui-datepicker-date">
								            <input name="startDateFirst" id="startDateFirst" class="startDate" readonly="" value="2018/07/01" type="text">
								           到
							            <input name="endDateFirst" id="endDateFirst" class="endDate" readonly="" value="2018/07/23" type="text">
							        </div>
							        <div class="opeDiv">
										<span class="Cancel" id="CancelFirst">取消</span>
							            <span class="Confirm" id="ConfirmFirst" onclick="datePickersFirst()">确定</span>
							        </div>
							    </div>
							</div>
						</div>
	            </div>
	            <div class="form-group col-lg-4">
	              <label>城市</label>
				  <input id="city_id" name="city_id_tradetype" type="hidden" value=""/>
				  <input type="text" class="form-control"  placeholder="城市" id="city_name" style="display: inherit;width: 90%;border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3)"/>
	              <div class="auto hidden" id="auto_city_member" style="width:85%;z-index: 99999;">
	              <!-- /.input group -->
	              </div>
	            </div>
	            </div>
	            </div>
	            
	            <div class="clearfix">
		            <div class="form-group col-lg-2 pull-right" style="margin-top: 20px; padding: 0 25px;">
		              <button type="button" onclick="export_city()" class="btn btn-block btn-warning">导出</button>
		            </div>
		            <div class="form-group col-lg-2 pull-right" style="margin-top: 20px; padding: 0 25px;">
		              <button type="button" class="btn btn-block btn-primary" onclick="searchInfo_step1(1)">查询</button>
		            </div>
		            
	            </div>
	
	          </div>
	          <div class="box-body">
	              <div class="tab-content">
	                <div>
	                  <table class="table table-striped">
	                    <tbody id="tradeType_tbody_city">
		                    <tr>
		                        <th width="8%">城市</th>
								<th>安心存</th>
								<th>淘金汇</th>
								<th>畅购卡升级</th>
								<th>兑换码</th>
								<th width="12%">199付费社员数</th>
								<th>其他</th>
								<th width="12%">
									新增社员数
									<font id="showattentioncity" style="color:#ffcc00;font-size:14px;font-weight:normal;">！</font>
									<font id="attentioncity" style="color:#47b8ef;font-size: 12px;white-space: nowrap;position: absolute;top:-15px;z-index: 1000;display:none;left:-10px">查询时间段内新增社员总数</font>
								</th>
							    <th width="12%">
								    累计社员总数
								    <label style="font-weight:normal;" id="query_city_info"></label>
							    </th>
		                    </tr>
	                    </tbody>
	                  </table>
	                </div>
	                <!-- /.tab-pane -->
	              </div>
	              <!-- /.tab-content -->
				  <div style="position:absolute;bottom:20px;left:27px;width:25%">显示 <select id="pageRecords_city" name="pageRecords_city" onchange="chnagePageRecords_City(2)"  style="height:25px;line-height:25px;border-radius:4px;"><option value="10" selected="selected">10</option><option value="50">50</option><option value="100">100</option></select> 条 &nbsp;&nbsp; 共  <span id="totalRecord_city"></span> 条</div>
				  <div class="tcdPageCode" id="page_city"></div>
	          </div>
	        </div>

			  <div class="tab-pane" id="tab_3">
				  <div class="box-body">
					  <div class="clearfix search-criteria">
						  <div id="selectorLine clearfix no-border" class="clearfix">
							  <div class="form-group col-lg-4">
								  <label>开卡时间</label>
								  <div class="search-con">
									  <div class="time" id="time_flag" style="width: 325px;z-index: 99999;margin:0 15px 0 0;">
										  <div class="time_endbg" id="last_time_endbg">
											  <p>日期选择：<span class="data_choice" id="last_data_choice">默认时期</span></p>
											  <input type="text" class="ui-datepicker-time" id="last_date" readonly="" value="">
										  </div>
									  </div>
									  <div class="ui-datepicker-css" id="last-ui-datepicker-css" style="margin: 0px 15px 0 0; display: none;">
										  <div class="ui-datepicker-quick" id="last-ui-datepicker-quick">
											  <input class="ui-date-quick-button" type="button" value="今天" alt="0"  name=""/>
											  <input class="ui-date-quick-button" type="button" value="昨天" alt="-1" name="">
											  <input class="ui-date-quick-button" type="button" value="7天内" alt="-6" name="">
											  <input class="ui-date-quick-button" type="button" value="30天内" alt="-29" name="">
											  <input class="ui-date-quick-button" type="button" value="60天内" alt="-59" name="">
											  <input class="ui-date-quick-button" type="button" value="全部" alt="1" name="">
											  <span class="ui-close-date" id="last-ui-close-date" style="cursor:pointer;">X</span>
										  </div>
										  <div class="ui-datepicker-choose">
											  <!--<p>自选日期</p>-->
											  <div class="ui-datepicker-date">
												  <input name="startDateLast" id="startDateLast" class="startDate" readonly="" value="2018/07/01" type="text">
												  到
												  <input name="endDateLast" id="endDateLast" class="endDate" readonly="" value="2018/07/23" type="text">
											  </div>
											  <div class="opeDiv">
												  <span class="Cancel" id="CancelLast">取消</span>
												  <span class="Confirm" id="ConfirmLast" onclick="datePickersLast()">确定</span>
											  </div>
										  </div>
									  </div>
								  </div>
							  </div>
							  <div class="form-group col-lg-4">
								  <label>城市</label>
								  <input id="city_id_try" name="city_id_try" type="hidden" value=""/>
								  <input type="text" class="form-control"  placeholder="城市" id="city_name_try" style="display: inherit;width: 90%;border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3)"/>
								  <div class="auto hidden" id="auto_city_try" style="width:85%;z-index: 99999;">
									  <!-- /.input group -->
								  </div>
							  </div>
							  <div class="form-group col-lg-4">
								  <label>门店</label>
								  <input id="store_id_try" name="store_id_try" type="hidden" value=""/>
								  <input type="text" class="form-control"  placeholder="门店" id="store_name_try" style="border-radius: 6px; box-shadow: 0 1px 1px rgba(0,0,0,0.3);width: 90%"/>
								  <div class="auto hidden" id="auto_store_try" style="width:85%;z-index: 99999;">
								  </div>
								  <!-- /.input group -->
							  </div>
						  </div>
					  </div>


					  <div class="clearfix">
						  <div class="form-group col-lg-2 pull-right" style="margin-top: 20px; padding: 0 25px;">
							  <button type="button" onclick="resetSerachParamTry()" style="border-color:#00a65a;background-color:#00a652;color:white" class="btn btn-block">重置</button>
						  </div>
						  <div class="form-group col-lg-2 pull-right" style="margin-top: 20px; padding: 0 25px;">
							  <button type="button" onclick="export_customer()" class="btn btn-block btn-warning">导出</button>
						  </div>
						  <div class="form-group col-lg-2 pull-right" style="margin-top: 20px; padding: 0 25px;">
							  <button type="button" class="btn btn-block btn-primary" onclick="searchInfo_step_customer(1)">查询</button>
						  </div>

					  </div>

				  </div>
				  <div class="box-body">
					  <div class="tab-content">
						  <div>
							  <table class="table table-striped">
								  <tbody id="tradeType_tbody_customer">
								  <tr>
									  <th width="8%">城市</th>
									  <th width="10%">门店名称</th>
									  <th width="10%">门店编号</th>
									  <th width="12%">新增试用社员数<label style="font-weight:normal;">（含过期）</label></th>
									  <th width="12%">
										  累计试用社员总数<label style="font-weight:normal;" id="query_try_info"></label>
									  </th>
								  </tr>
								  </tbody>
							  </table>
						  </div>
						  <!-- /.tab-pane -->
					  </div>
					  <!-- /.tab-content -->
					  <div style="position:absolute;bottom:20px;left:27px;width:25%">显示 <select id="pageRecords_customer" name="pageRecords_customer" onchange="chnagePageRecords_Customer(2)"  style="height:25px;line-height:25px;border-radius:4px;"><option value="10" selected="selected">10</option><option value="50">50</option><option value="100">100</option></select> 条 &nbsp;&nbsp; 共  <span id="totalRecord_customer"></span> 条</div>
					  <div class="tcdPageCode" id="page_customer"></div>
				  </div>
			  </div>
        </div>
        </div>
      </section>
    </div>
  </div>
  <!-- /.content-wrapper -->
</div>

<!-- ./wrapper -->
<script src="plugins/date-new/js/jQuery-2.2.0.min.js"></script>
<script src="plugins/date-new/js/jquery-ui-1.9.2.custom.js" type = "text/javascript"></script>
<script src="plugins/date-new/js/share.js" type = "text/javascript"></script>
<!-- Bootstrap 3.3.6 -->
<script src="bootstrap/js/bootstrap.min.js"></script>
<!-- Morris.js charts -->
<script src="bootstrap/js/raphael-min.js"></script>
<script src="plugins/morris/morris.min.js"></script>
<!-- FastClick -->
<script src="plugins/fastclick/fastclick.js"></script>
<!-- AdminLTE App -->
<script src="dist/js/app.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="dist/js/demo.js"></script>

<!-- page script -->
<script type="text/javascript" src="plugins/jquery.page.js"></script>
<script type="text/javascript" src="plugins/moment.min.js"></script>
<script src="plugins/daterangepicker/daterangepicker.js"></script>

<script type="text/javascript" src="../scripts/bidLibjsjquery3.0.js"></script>
<script type="text/javascript" src="../scripts/auto.js"></script> 
<script type="text/javascript">


<!--target(数据查询层级标识) 0:总部  1:城市级别 2:门店-->
	layer.config({
	  extend: 'skin/crmskin/style.css' //加载新皮肤
	});
	var cityId = decode64(getUrlParamByKey("c"));//城市ID
	var initCity = cityId;
	var cityName = decode64(getUrlParamByKey("cn"));//城市名称
	var employeeId = decode64(getUrlParamByKey("e"));//员工编号/id
	var storeId = decode64(getUrlParamByKey("s"));//门店编号
	var target = decode64(getUrlParamByKey("t"));//target 0：总部  1:城市级别 2：门店
	var storeName=decode64(getUrlParamByKey("sn"));
	var storeNo=decode64(getUrlParamByKey("so"));
	var role = decode64(getUrlParamByKey("r"));
	var fromBar = decode64(getUrlParamByKey("fb"));
	var beti = decode64(getUrlParamByKey("beTi"));
	var endt = decode64(getUrlParamByKey("endT"));
	
	$(function () {
		$("#ui-datepicker-quick input").click(function(){
		    var buttonValue= $(this).val();
		    $('#data_choice').html(buttonValue);
		});
		$("#first-ui-datepicker-quick input").click(function(){
		    var buttonValue= $(this).val();
		    $('#first_data_choice').html(buttonValue);
		});
        $("#last-ui-datepicker-quick input").click(function(){
            var buttonValue= $(this).val();
            $('#last_data_choice').html(buttonValue);
        });
        var sdate = $("#first_date").val();
        var begin_end_date=["",""];
        if(sdate!=""){
            begin_end_date = sdate.split("-");
        }
        $("#query_store_info").text("（截止到"+begin_end_date[1]+"）");
        $("#query_city_info").text("（截止到"+begin_end_date[1]+"）");
        $("#query_try_info").text("（有效期内截止到"+begin_end_date[1]+"）");
		if(target==0){//总部
			if(cityName!=""){
			    //门店单位社员
				$("#city_name_tradetype").val(cityName);
                $("#city_name_tradetype").attr("readonly",true);
                $("#city_id_tradetype").val(cityId);
                //城市单位社员
				$("#city_name").val(cityName);
                $("#city_name").attr("readonly",true);
                $("#city_id").val(cityId);
                //试用社员
                $("#city_name_try").val(cityName);
                $("#city_name_try").attr("readonly",true);
                $("#city_id_try").val(cityId);

			}
		}else if(target==1){//城市
			$("#city_name_tradetype").val(cityName);
			$("#city_name_tradetype").attr("readonly",true);
			$("#city_name").val(cityName);
			$("#city_name").attr("readonly",true);
            $("#city_name_try").val(cityName);
            $("#city_name_try").attr("readonly",true);
		}else if(target==2){//店长
			$("#tab_2_avtive").hide();
			$("#tab_2").hide();
            $("#tab_1_avtive").addClass("active");
            $("#tab_1").addClass("active");
			$("#city_name_tradetype").val(cityName);
			$("#city_name_tradetype").attr("readonly",true);
			$("#store_name_tradetype").val(storeName);
			$("#store_name_tradetype").attr("readonly",true);
            $("#city_name_try").val(cityName);
            $("#city_name_try").attr("readonly",true);
		}
		if(fromBar == "1"){//定位城市tab
			$("#first_date").attr("value",beti +'-'+ endt);
		    $("#startDateFirst").attr("value",beti);
		    $("#endDateFirst").attr("value",endt);
			searchInfo_step2();
			$("#tab_2_avtive").addClass("active");
			$("#tab_2").addClass("active");
			$("#tab_1_avtive").removeClass("active");
			$("#tab_1").removeClass("active");
		}else if(fromBar == "2"){//定位门店tab
			$("#searchTime").attr("value",beti +'-'+ endt);
		    $("#startOpenCardDate").attr("value",beti);
		    $("#endOpenCardDate").attr("value",endt);
			searchInfo_tradetype_step2();
		}else if(fromBar == "3"){//定位试用社员tab
            $("#tab_3_avtive").addClass("active");
            $("#tab_3").addClass("active");
            $("#tab_1_avtive").removeClass("active");
            $("#tab_1").removeClass("active");
            $("#bigmember").hide();
		}
	    $(".logo-lg > ul > li").hover(function(){
	      $(this).children(".nav_dropdown").toggle('1000');
	    });

        $("#bighide").on("click",function(event){
            $("#bigmember").hide();
        });
        $("#bigshow1").on("click",function(event){
            $("#bigmember").show();
        });
        $("#bigshow2").on("click",function(event){
            $("#bigmember").show();
        });

	    
	    //门店纬度
	    $("#showattention").on("mouseover",function(event){
	  		$("#attention").show();
	  	});
	  	$("#showattention").on("mouseout",function(event){
	  		$("#attention").hide();
	  	});
	  	//城市纬度
	  	$("#showattentioncity").on("mouseover",function(event){
	  		$("#attentioncity").show();
	  	});
	  	$("#showattentioncity").on("mouseout",function(event){
	  		$("#attentioncity").hide();
	  	});

  });
  /**-----------------------------------搜索城市------------------------------------------------------**/
  var lst_select_city=null;
  var cityNameArray=new Array();
  var cityIdMap = {};
  $('#city_name_tradetype').keyup(function(event){//门店交易额统计
	  cityNameArray=new Array();
	   $("#auto_city").empty();
	   $("#auto_store").empty();
	   $("#store_id_tradetype").val("");
	   $("#store_name_tradetype").val("");
        var str_name = $(this).val();
        if(!(event.keyCode >= 37 && event.keyCode <= 40) && event.keyCode != 13){
        	$("#city_id_tradetype").val("");
            //$('#city_name-search_tradetype').children().remove();
            if(str_name == null || str_name == "" || str_name.indexOf('\'') > -1){
                return;
            }
            var city_id = null;
            if(target==1){
            	city_id = cityId;
            	
            }
            doManager('dynamicManager','selectAllCity',null,function(data){
                if(data.result){
                	
                	lst_select_city = JSON.parse(data.data);
                	 for(var i=0;i<lst_select_city.length;i++){
                		 cityNameArray.push(lst_select_city[i].cityname);
                     	 cityIdMap[lst_select_city[i].cityname] = lst_select_city[i].id;
       			  	 }
       			  	var autoComplete = new AutoComplete("city_name_tradetype","auto_city",cityNameArray);
       			    autoComplete.start(event);
                }else{
                	
                }
            });
        }
    });

$('#city_name').keyup(function(event){//门店交易额统计
    cityNameArray=new Array();
    $("#auto_city_member").empty();
    var str_name = $(this).val();
    if(!(event.keyCode >= 37 && event.keyCode <= 40) && event.keyCode != 13){
        $("#city_id").val("");
        if(str_name == null || str_name == "" || str_name.indexOf('\'') > -1){
            return;
        }
        var city_id = null;
        if(target==1){
            city_id = cityId;

        }
        doManager('dynamicManager','selectAllCity',null,function(data){
            if(data.result){

                lst_select_city = JSON.parse(data.data);
                for(var i=0;i<lst_select_city.length;i++){
                    cityNameArray.push(lst_select_city[i].cityname);
                    cityIdMap[lst_select_city[i].cityname] = lst_select_city[i].id;
                }
                var autoComplete = new AutoComplete("city_name","auto_city_member",cityNameArray);
                autoComplete.start(event);
            }else{

            }
        });
    }
});
  
  $('#city_name_try').keyup(function(event){//门店交易额统计
	  cityNameArray=new Array();
	   $("#auto_city_try").empty();
        var str_name = $(this).val();
        if(!(event.keyCode >= 37 && event.keyCode <= 40) && event.keyCode != 13){
        	$("#city_id_try").val("");
            if(str_name == null || str_name == "" || str_name.indexOf('\'') > -1){
                return;
            }
            var city_id = null;
            if(target==1){
            	city_id = cityId;
            	
            }
            doManager('dynamicManager','selectAllCity',null,function(data){
                if(data.result){
                	lst_select_city = JSON.parse(data.data);
                	 for(var i=0;i<lst_select_city.length;i++){
                		 cityNameArray.push(lst_select_city[i].cityname);
                     	 cityIdMap[lst_select_city[i].cityname] = lst_select_city[i].id;
       			  	 }
       			  	var autoComplete = new AutoComplete("city_name_try","auto_city_try",cityNameArray);
       			    autoComplete.start(event);
                }else{
                	
                }
            });
        }
    });

	  $('#auto_city').on("click",function(){
		  var temp_city = document.getElementById("city_name_tradetype").value.replace(/(\s*)|(\s*)/g,'').replace(/[ ]/g,'');
		  $("#city_id_tradetype").val(cityIdMap[temp_city]);
	  }); 
	  
	  $('#auto_city_member').on("click",function(){
		  var temp_city = document.getElementById("city_name").value.replace(/(\s*)|(\s*)/g,'').replace(/[ ]/g,'');
		  $("#city_id").val(cityIdMap[temp_city]);
	  });
	$('#auto_city_try').on("click",function(){
		var temp_city = document.getElementById("city_name_try").value.replace(/(\s*)|(\s*)/g,'').replace(/[ ]/g,'');
		$("#city_id_try").val(cityIdMap[temp_city]);
	});
     
     
     
  
  /**-----------------------------------搜索门店------------------------------------------------------**/
  var lst_select_store=null;
  var storeNameArray=new Array();
  var storeIdMap = {};
  $('#store_name_tradetype').keyup(function(event){
	  storeNameArray=new Array();
	    $("#auto_store").empty();
        var str_name = $(this).val();
        if(!(event.keyCode >= 37 && event.keyCode <= 40) && event.keyCode != 13){
        	$("#store_id_tradetype").val("");
            if(str_name == null || str_name == "" || str_name.indexOf('\'') > -1){
                return;
            }
            var city_id = null;
            if(target==0){//总部
            	 city_id = ($("#city_id_tradetype").val())==""?null:($("#city_id_tradetype").val());
            	 var city_name =  $("#city_name_tradetype").val();
                 if(city_id==null&&city_name!=""){
                 	city_id=-10000;
                 }
            }else if(target==1){//城市
            	city_id = cityId;
            }
            
            doManager('dynamicManager','getStoreByCity',[target,employeeId,city_id,str_name],function(data){
                if(data.result){
                	
                	lst_select_store = JSON.parse(data.data).storelist;
                    
                    for(i=0;i<lst_select_store.length;i++){
                    	storeNameArray.push(lst_select_store[i].name);
                    	storeIdMap[lst_select_store[i].name] = lst_select_store[i].store_id;
      			  	}
      			  	var autoComplete = new AutoComplete("store_name_tradetype","auto_store",storeNameArray);
      			    autoComplete.start(event);
                }else{
                	
                }
            });
        }
    });

$('#store_name_try').keyup(function(event){
    storeNameArray=new Array();
    $("#auto_store_try").empty();
    var str_name = $(this).val();
    if(!(event.keyCode >= 37 && event.keyCode <= 40) && event.keyCode != 13){
        $("#store_id_try").val("");
        if(str_name == null || str_name == "" || str_name.indexOf('\'') > -1){
            return;
        }
        var city_id = null;
        if(target==0){//总部
            city_id = ($("#city_id_try").val())==""?null:($("#city_id_try").val());
            var city_name =  $("#city_name_try").val();
            if(city_id==null&&city_name!=""){
                city_id=-10000;
            }
        }else if(target==1){//城市
            city_id = cityId;
        }

        doManager('dynamicManager','getStoreByCity',[target,employeeId,city_id,str_name],function(data){
            if(data.result){
                lst_select_store = JSON.parse(data.data).storelist;
                for(var i=0;i<lst_select_store.length;i++){
                    storeNameArray.push(lst_select_store[i].name);
                    storeIdMap[lst_select_store[i].name] = lst_select_store[i].store_id;
                }
                var autoComplete = new AutoComplete("store_name_try","auto_store_try",storeNameArray);
                autoComplete.start(event);
            }else{

            }
        });
    }
});

	  $('#auto_store').on("click",function(){
		  var temp_store = document.getElementById("store_name_tradetype").value.replace(/(\s*)|(\s*)/g,'').replace(/[ ]/g,'');
		  $("#store_id_tradetype").val(storeIdMap[temp_store]);
	 });
	$('#auto_store_try').on("click",function(){
		var temp_store = document.getElementById("store_name_try").value.replace(/(\s*)|(\s*)/g,'').replace(/[ ]/g,'');
		$("#store_id_try").val(storeIdMap[temp_store]);
	});
     
     
    
 
    <!-------------------------------------------------------点击查询----------------------------------------------------------------->  
   	//门店分页查询
    var isCreatePage1=false;
    function searchInfo_tradetype_step1(cur_page){
    	isCreatePage1=false;
  		searchInfo_tradetype_step2(cur_page);
  	}

	var manualPageRecordeStore=10;
	function chnagePageRecords_Store(t){
		$("#page_tradetype").empty();
        manualPageRecordeStore  = $("#pageRecords_store").val();
        searchInfo_tradetype_step1(1);
	}
    //城市分页查询
    var isCityCreatePage1=false;
    function searchInfo_step1(cur_page){
    	isCityCreatePage1=false;
    	searchInfo_step2(cur_page);
  	}

	var manualPageRecordeCity=10;
	function chnagePageRecords_City(t){
		$("#page_city").empty();
        manualPageRecordeCity  = $("#pageRecords_city").val();
        searchInfo_step1(1);
	}

	var isCustomerCreatePage1=false;
	function searchInfo_step_customer(cur_page){
		isCustomerCreatePage1=false;
		searchInfo_customer(cur_page);
	}

	var manualPageRecordeCustomer=10;
	function chnagePageRecords_Customer(t){
		$("#page_customer").empty();
        manualPageRecordeCustomer  = $("#pageRecords_customer").val();
        searchInfo_step_customer(1);
	}
    
    var currentPage_city = 1;
    var totalPage_city = 1;
    function searchInfo_step2(cur_page){
    	//注册时间
	    var sdate = $("#first_date").val();
	    var begin_end_date=["",""];
	  	if(sdate!=""){
	  		begin_end_date = sdate.split("-");
	   	}
    	$("#process_div").show();
   	 	$("#process_div_pic").show();
   	 	
 	   var dynamicDto=null;
 	   if(target==0){//总部
 		  var cityId = $("#city_id").val();
 		  var cityName = $("#city_name").val();
 		  if(cityId==""&&cityName!=""){
 			 cityId="-10000";
 		  }
 		  dynamicDto = {
 	  				beginDate:begin_end_date[0].trim(),
 	  				endDate:begin_end_date[1].trim(),
 	  				cityId:cityId,
 	  		  		employeeId:employeeId,
 	  		  		target:target,
 	  		  		searchstr:"city"
 	  			}
 	   }else if(target==1){//城市
	    	 dynamicDto = {
	    		beginDate:begin_end_date[0].trim(),
	 	  		endDate:begin_end_date[1].trim(),
  				cityId:initCity,
  		  		employeeId:employeeId,
  		  		target:target,
  		  		searchstr:"city"
  			}
	    }
 	    var pageInfo = new Object();
 	    pageInfo.currentPage = cur_page;
        pageInfo.recordsPerPage = manualPageRecordeCity;
        $("#totalRecord_city").html("0");
        $("#query_city_info").text("（截止到"+begin_end_date[1]+"）");
	    doManager('dynamicManager','getUserMemberInfo',[dynamicDto,pageInfo],function(data){
           if(data.result){
           	   var result= JSON.parse(data.data);
	           if(result.status=='success'){
	        	   $("#tradeType_tbody_city").find("tr:gt(0)").remove(); 
	        	   var jData = result.member;
	        	   if(jData==null||jData.length==0){
	        		   crm_alert(5,"没有符合条件的数据！");
	        		   $("#page_city").createPage({
	        	 	  	    pageCount:0,
	        	 	  	    current:0,
	        	 	  	    backFn:function(p){
	        	 	  	    	
	        	 	  	    }
	        	 	  	});
	        		   $("#process_div").hide();
	        	       $("#process_div_pic").hide();
	        		   return;
	        	   }
	        	   totalPage_city = result.total_pages;
                   $("#totalRecord_city").html(result.pageinfo.totalRecords);
	        	  
	        	   if(!isCityCreatePage1){
	        		   $("#page_city").createPage({
	   	       	  	    pageCount:totalPage_city,
	   	       	  	    current:cur_page,
	   	       	  	    backFn:function(p){
	   	       	  			searchInfo_step2(p,begin_end_date);
	   	       	  	    }
	   	       	  	  });
	        		   isCityCreatePage1=true;
	        	   }
	        	   
	        	   var infoStr="";
	        	   for(var i=0;i<jData.length;i++){
	        		   var cityname = jData[i].city_name;
                       var cityno = jData[i].cityno;
	        		   if(cityname == '无'){
	        			   cityname = $("#city_name").val() == "" ? cityname : $("#city_name").val();
	        		   }
                       infoStr="";
	        		   infoStr += "<tr>"
		                       +"<td>"+cityname+"</td>"
                           		+"<td style='display: none;'>"+cityno+"</td>";
					   if(cityname == '无'){
                           infoStr += "<td>"+jData[i].axccount+"</td>"
						   +"<td>"+jData[i].tjhcount+"</td>"
						   +"<td>"+jData[i].cgkcount+"</td>"
						   +"<td>"+jData[i].dhmcount+"</td>"
                           +"<td>"+jData[i].count199+"</td>"
                           +"<td>"+jData[i].othercount+"</td>"
                           +"<td>"+jData[i].nowcount+"</td>"
                       }else{
                           /*infoStr +="<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&c="+encode64(cityno)+"&tag="+encode64("安心存")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"\">"+jData[i].axccount+"</a></td>"
                           +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&c="+encode64(cityno)+"&tag="+encode64("淘金汇")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"\">"+jData[i].tjhcount+"</a></td>"
                           +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&c="+encode64(cityno)+"&tag="+encode64("畅卡升级")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"\">"+jData[i].cgkcount+"</a></td>"
                           +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&c="+encode64(cityno)+"&tag="+encode64("兑换码")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"\">"+jData[i].dhmcount+"</a></td>"
                           +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&c="+encode64(cityno)+"&tag="+encode64("199付费社员")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"\">"+jData[i].count199+"</a></td>"
						   +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&c="+encode64(cityno)+"&tag="+encode64("其他")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"\">"+jData[i].othercount+"</a></td>"
						   +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&c="+encode64(cityno)+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"\">"+jData[i].nowcount+"</a></td>"*/
                           infoStr +="<td>"+jData[i].axccount+"</td>"
                               +"<td>"+jData[i].tjhcount+"<</td>"
                               +"<td>"+jData[i].cgkcount+"</td>"
                               +"<td>"+jData[i].dhmcount+"</td>"
                               +"<td>"+jData[i].count199+"</td>"
                               +"<td>"+jData[i].othercount+"</td>"
                               +"<td>"+jData[i].nowcount+"</td>"
                       }
                       infoStr += "<td>"+jData[i].opencount+"</td>"
		                       +"</tr>";
		                       
		                  $("#tradeType_tbody_city").append(infoStr);     
	        	   }
	           }else if(result.status=='storefail'){
	        	   $("#tradeType_tbody_city").find("tr:gt(0)").remove(); 
	           	   crm_alert(5,JSON.parse(result.data).message);
		           	$("#page_city").createPage({
		   	 	  	    pageCount:0,
		   	 	  	    current:0,
		   	 	  	    backFn:function(p){
		   	 	  	    	
		   	 	  	    }
		   	 	  	});
	        	   $("#process_div").hide();
	    	       $("#process_div_pic").hide();
	        	   return;
	           }else{
	        	   crm_alert(5,"请稍后重新请求！");
	        	   $("#process_div").hide();
        	       $("#process_div_pic").hide();
	        	   return;
	           }
           
           }else{
        	   crm_alert(5,"请稍后重新请求！");
           }
          $("#process_div").hide();
     	  $("#process_div_pic").hide();
       }); 
    }
    
    
    
    
    
    //查询上
    var currentPage_tradetype = 1;
    var totalPage_tradetype = 1;   
    function searchInfo_tradetype_step2(cur_page){
    	//注册时间
	    var sdate = $("#searchTime").val();
	    var begin_end_date=["",""];
	  	if(sdate!=""){
	  		begin_end_date = sdate.split("-");
	   	}
    	$("#process_div").show();
   	 	$("#process_div_pic").show();
 	    var number_str = $("#store_id_tradetype").val(); 
 	    var storeName = $("#store_name_tradetype").val();
 	    
 	    if(number_str==""&&storeName!=""){
 	    	number_str=-10000;
 	    }
 	   var dynamicDto=null;
 	   if(target==0){//总部
 		  var cityId = $("#city_id_tradetype").val();
 		  var cityName = $("#city_name_tradetype").val();
 		  if(cityId==""&&cityName!=""){
 			 cityId="-10000";
 		  }
 		  dynamicDto = {
 	  				beginDate:begin_end_date[0].trim(),
 	  				endDate:begin_end_date[1].trim(),
 	  				storeNumer:number_str,
 	  				cityId:cityId,
 	  		  		employeeId:employeeId,
 	  		  		target:target,
 	  		  		storeId:number_str,
 	  		  		searchstr:"store"
 	  			}
 	   }else if(target==1){//城市
	    	 dynamicDto = {
	    		beginDate:begin_end_date[0].trim(),
	 	  		endDate:begin_end_date[1].trim(),
  				storeNumer:number_str,
  				cityId:initCity,
  		  		employeeId:employeeId,
  		  		target:target,
  		  		storeId:number_str,
  		  		searchstr:"store"
  			}
	    }else if(target==2){//店长
	    	dynamicDto = {
	    		beginDate:begin_end_date[0].trim(),
 	  			endDate:begin_end_date[1].trim(),
  				storeNumer:number_str,
  		  		employeeNo:employeeId,
  		  		storeId:storeId,
  		  		target:target,
  		  		searchstr:"store"
  			}
	    }else if(target==3){//事业部
	    	dynamicDto = {
	    			beginDate:begin_end_date[0].trim(),
 	  				endDate:begin_end_date[1].trim(),
	  				storeNumer:number_str,
	  		  		employeeNo:employeeId,
	  		  		storeId:number_str,
	  		  		target:target,
	  		  		searchstr:"store"
	  			}
	    }
 	    var pageInfo = new Object();
 	    pageInfo.currentPage = cur_page;
        pageInfo.recordsPerPage = manualPageRecordeStore;
        $("#totalRecord_store").html("0");
        $("#query_store_info").text("（截止到"+begin_end_date[1]+"）");
	    doManager('dynamicManager','getUserMemberInfo',[dynamicDto,pageInfo],function(data){
           if(data.result){
           	   var result= JSON.parse(data.data);
	           if(result.status=='success'){
	        	   $("#tradeType_tbody").find("tr:gt(0)").remove(); 
	        	   var jData = result.member;
	        	   if(jData==null||jData.length==0){
	        		   crm_alert(5,"没有符合条件的数据！");
	        		   $("#page_tradetype").createPage({
	        	 	  	    pageCount:0,
	        	 	  	    current:0,
	        	 	  	    backFn:function(p){
	        	 	  	    	
	        	 	  	    }
	        	 	  	});
	        		   $("#process_div").hide();
	        	       $("#process_div_pic").hide();
	        		   return;
	        	   }
	        	   totalPage_tradetype = result.total_pages;
                   $("#totalRecord_store").html(result.pageinfo.totalRecords);
	        	   if(!isCreatePage1){
	        		   $("#page_tradetype").createPage({
	   	       	  	    pageCount:totalPage_tradetype,
	   	       	  	    current:cur_page,
	   	       	  	    backFn:function(p){
	   	       	  			searchInfo_tradetype_step2(p,begin_end_date);
	   	       	  	    }
	   	       	  	  });
	        		   isCreatePage1=true;
	        	   }
	        	   
	        	   var infoStr="";
	        	   for(var i=0;i<jData.length;i++){
	        		   var cityname = jData[i].city_name;
	        		   if(cityname == '无'){
	        			   cityname = $("#city_name_tradetype").val() == "" ? cityname : $("#city_name_tradetype").val();
	        		   }
                       infoStr="";
	        		   infoStr += "<tr>"
		                       +"<td>"+cityname+"</td>"
		                       +"<td>"+jData[i].name+"</td>"
		                       +"<td>"+jData[i].storeno+"</td>"
                           		+"<td style='display: none'>"+jData[i].platformid+"</td>";
					   if(jData[i].name == '无'){
						   infoStr += "<td>"+jData[i].axccount+"</td>"
						   +"<td>"+jData[i].tjhcount+"</td>"
						   +"<td>"+jData[i].cgkcount+"</td>"
						   +"<td>"+jData[i].dhmcount+"</td>"
                           +"<td>"+jData[i].count199+"</td>"
                           +"<td>"+jData[i].othercount+"</td>"
							+"<td>"+jData[i].nowcount+"</td>"
					   }else{
						   /*infoStr += "<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&tag="+encode64("安心存")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"&s="+encode64(jData[i].platformid)+"&sn="+encode64(jData[i].name)+"\">"+jData[i].axccount+"</a></td>"
						   +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&tag="+encode64("淘金汇")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"&s="+encode64(jData[i].platformid)+"&sn="+encode64(jData[i].name)+"\">"+jData[i].tjhcount+"</a></td>"
						   +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&tag="+encode64("畅卡升级")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"&s="+encode64(jData[i].platformid)+"&sn="+encode64(jData[i].name)+"\">"+jData[i].cgkcount+"</a></td>"
						   +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&tag="+encode64("兑换码")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"&s="+encode64(jData[i].platformid)+"&sn="+encode64(jData[i].name)+"\">"+jData[i].dhmcount+"</a></td>"
                           +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&tag="+encode64("199付费社员")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"&s="+encode64(jData[i].platformid)+"&sn="+encode64(jData[i].name)+"\">"+jData[i].count199+"</a></td>"
						   +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&tag="+encode64("其他")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"&s="+encode64(jData[i].platformid)+"&sn="+encode64(jData[i].name)+"\">"+jData[i].othercount+"</a></td>"
						   +"<td><a target=\"memberData_list\" href=\"memberData_list.html?t="+encode64(target)+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"&s="+encode64(jData[i].platformid)+"&sn="+encode64(jData[i].name)+"\">"+jData[i].nowcount+"</a></td>"*/
                           infoStr += "<td>"+jData[i].axccount+"</td>"
                               +"<td>"+jData[i].tjhcount+"</td>"
                               +"<td>"+jData[i].cgkcount+"</td>"
                               +"<td>"+jData[i].dhmcount+"</td>"
                               +"<td>"+jData[i].count199+"</td>"
                               +"<td>"+jData[i].othercount+"</td>"
                               +"<td>"+jData[i].nowcount+"</td>"
					   }
					   infoStr += "<td>"+jData[i].opencount+"</td>"
		                       +"</tr>";
		                       
		                  $("#tradeType_tbody").append(infoStr);     
	        	   }
	           }else if(result.status=='storefail'){
	        	   $("#tradeType_tbody").find("tr:gt(0)").remove(); 
	           	   crm_alert(5,JSON.parse(result.data).message);
		           	$("#page_tradetype").createPage({
		   	 	  	    pageCount:0,
		   	 	  	    current:0,
		   	 	  	    backFn:function(p){
		   	 	  	    	
		   	 	  	    }
		   	 	  	});
	        	   $("#process_div").hide();
	    	       $("#process_div_pic").hide();
	        	   return;
	           }else{
	        	   crm_alert(5,"请稍后重新请求！");
	        	   $("#process_div").hide();
        	       $("#process_div_pic").hide();
	        	   return;
	           }
           
           }else{
        	   crm_alert(5,"请稍后重新请求！");
           }
          $("#process_div").hide();
     	  $("#process_div_pic").hide();
       }); 
    }

var currentPage_customer = 1;
var totalPage_customer = 1;
function searchInfo_customer(cur_page){
    //注册时间
    var sdate = $("#last_date").val();
    var begin_end_date=["",""];
    if(sdate!=""){
        begin_end_date = sdate.split("-");
    }
    $("#process_div").show();
    $("#process_div_pic").show();
    var number_str = $("#store_id_try").val();
    var storeName = $("#store_name_try").val();

    if(number_str==""&&storeName!=""){
        number_str=-10000;
    }
    var dynamicDto=null;
    if(target==0){//总部
        var cityId = $("#city_id_try").val();
        var cityName = $("#city_name_try").val();
        if(cityId==""&&cityName!=""){
            cityId="-10000";
        }
        dynamicDto = {
            beginDate:begin_end_date[0].trim(),
            endDate:begin_end_date[1].trim(),
            storeNumer:number_str,
            cityId:cityId,
            employeeId:employeeId,
            target:target,
            storeId:number_str,
            searchstr:"try_member"
        }
    }else if(target==1){//城市
        dynamicDto = {
            beginDate:begin_end_date[0].trim(),
            endDate:begin_end_date[1].trim(),
            storeNumer:number_str,
            cityId:initCity,
            employeeId:employeeId,
            target:target,
            storeId:number_str,
            searchstr:"try_member"
        }
    }else if(target==2){//店长
        dynamicDto = {
            beginDate:begin_end_date[0].trim(),
            endDate:begin_end_date[1].trim(),
            storeNumer:number_str,
            employeeNo:employeeId,
            storeId:storeId,
            target:target,
            searchstr:"try_member"
        }
    }else if(target==3){//事业部
        dynamicDto = {
            beginDate:begin_end_date[0].trim(),
            endDate:begin_end_date[1].trim(),
            storeNumer:number_str,
            employeeNo:employeeId,
            storeId:number_str,
            target:target,
            searchstr:"try_member"
        }
    }
    var pageInfo = new Object();
    pageInfo.currentPage = cur_page;
    pageInfo.recordsPerPage = manualPageRecordeCustomer;
    $("#totalRecord_customer").html("0");
    $("#query_try_info").text("（有效期内截止到"+begin_end_date[1]+"）");

    doManager('dynamicManager','getUserMemberInfo',[dynamicDto,pageInfo],function(data){
        if(data.result){
            var result= JSON.parse(data.data);
            if(result.status=='success'){
                $("#tradeType_tbody_customer").find("tr:gt(0)").remove();
                var jData = result.member;
                if(jData==null||jData.length==0){
                    crm_alert(5,"没有符合条件的数据！");
                    $("#page_customer").createPage({
                        pageCount:0,
                        current:0,
                        backFn:function(p){
                        }
                    });
                    $("#process_div").hide();
                    $("#process_div_pic").hide();
                    return;
                }
                totalPage_customer = result.total_pages;
                $("#totalRecord_customer").html(result.pageinfo.totalRecords);
                if(!isCustomerCreatePage1){
                    $("#page_customer").createPage({
                        pageCount:totalPage_customer,
                        current:cur_page,
                        backFn:function(p){
                            searchInfo_customer(p,begin_end_date);
                        }
                    });
                    isCustomerCreatePage1=true;
                }

                var infoStr="";
                for(var i=0;i<jData.length;i++){
                    var cityname = jData[i].city_name;
                    if(cityname == '无'){
                        cityname = $("#city_name_try").val() == "" ? cityname : $("#city_name_try").val();
                    }
                    infoStr="";
                    infoStr += "<tr>"
                        +"<td>"+cityname+"</td>"
                        +"<td>"+jData[i].name+"</td>"
                        +"<td>"+jData[i].storeno+"</td>";
                    //if(jData[i].name == '无'){
                        infoStr += "<td>"+jData[i].nowcount+"</td>";
                    /*}else{
                        infoStr += "<td><a target=\"userProfile_view\" href=\"RuserProfile_view.html?t="+encode64(target)+"&tag="+encode64("V")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"&so="+encode64(jData[i].storeno)+"&sn="+encode64(jData[i].name)+"\">"+jData[i].nowcount+"</a></td>"
                            +"<td><a target=\"userProfile_view\" href=\"userProfile_view.html?t="+encode64(target)+"&mt="+encode64("associator_start_2")+"&tag="+encode64("V")+"&time="+encode64(sdate)+"&cn="+encode64(cityname)+"&so="+encode64(jData[i].storeno)+"&sn="+encode64(jData[i].name)+"\">"+jData[i].count199+"</a></td>"
                    }*/
                    infoStr += "<td>"+jData[i].opencount+"</td></tr>";

                    $("#tradeType_tbody_customer").append(infoStr);                }
            }else if(result.status=='storefail'){
                $("#tradeType_tbody_customer").find("tr:gt(0)").remove();
                crm_alert(5,JSON.parse(result.data).message);
                $("#page_customer").createPage({
                    pageCount:0,
                    current:0,
                    backFn:function(p){

                    }
                });
                $("#process_div").hide();
                $("#process_div_pic").hide();
                return;
            }else{
                crm_alert(5,"请稍后重新请求！");
                $("#process_div").hide();
                $("#process_div_pic").hide();
                return;
            }

        }else{
            crm_alert(5,"请稍后重新请求！");
        }
        $("#process_div").hide();
        $("#process_div_pic").hide();
    });
}
    
    
    //导出上第二步
    function export_tradetype(){
    	//注册时间
	    var sdate = $("#searchTime").val();
	    var begin_end_date=["",""];
	  	if(sdate!=""){
	  		begin_end_date = sdate.split("-");
	   	}
    	$("#process_div").show();
  	 	$("#process_div_pic").show();
   		
	    var number_str = $("#store_id_tradetype").val(); 
	    var storeName = $("#store_name_tradetype").val();
	    
 	    if(number_str==""&&storeName!=""){
 	    	number_str=-10000;
 	    }
 	   var dynamicDto=null;
 	   if(target==0){//总部
 		  var cityId = $("#city_id_tradetype").val();
 		  var cityName = $("#city_name_tradetype").val();
		  if(cityId==""&&cityName!=""){
			 cityId="-10000";
		  }
 		  dynamicDto = {
 				 	beginDate:begin_end_date[0].trim(),
 	 	  			endDate:begin_end_date[1].trim(),
 	  				storeNumer:number_str,
 	  				cityId:cityId,
 	  		  		employeeId:employeeId,
 	  		  		target:target,
 	  		  		storeId:number_str,
 	  		  		searchstr:"store"
 	  			}
 	   }else if(target==1){//城市
	    	 dynamicDto = {
	    		beginDate:begin_end_date[0].trim(),
	 	 	  	endDate:begin_end_date[1].trim(),
  				storeNumer:number_str,
  				cityId:initCity,
  		  		employeeId:employeeId,
  		  		target:target,
  		  		storeId:number_str,
  		  		searchstr:"store"
  			}
	    }else if(target==2){//店长
	    	dynamicDto = {
	    		beginDate:begin_end_date[0].trim(),
		 	  	endDate:begin_end_date[1].trim(),
  				storeNumer:number_str,
  		  		employeeNo:employeeId,
  		  		storeId:storeId,
  		  		target:target,
  		  		searchstr:"store"
  			}
	    }
	   
	    doManager('dynamicManager','exportUserMemberInfo',[dynamicDto],function(data){
          if(data.result){
          	   var result= JSON.parse(data.data);
	           if(result.status=='success'){
	        	   window.location.href=result.data;
	           }else if(result.status=='null'){
	        	   crm_alert(0,"请先确认是否有符合条件的数据，重新请求！");
	        	   $("#process_div").hide();
        	       $("#process_div_pic").hide();
	        	   return;
	           }else{
	        	   crm_alert(5,"请稍后重新请求！");
	        	   $("#process_div").hide();
        	       $("#process_div_pic").hide();
	           }
          
          }else{
       	   crm_alert(5,"请稍后重新请求！");
          }
         $("#process_div").hide();
    	 $("#process_div_pic").hide();
      }); 
    }
    
    
    
  //导出城市
    function export_city(){
    	//注册时间
	    var sdate = $("#first_date").val();
	    var begin_end_date=["",""];
	  	if(sdate!=""){
	  		begin_end_date = sdate.split("-");
	   	}
    	$("#process_div").show();
  	 	$("#process_div_pic").show();
  	 	var dynamicDto=null;
  	   if(target==0){//总部
  		  var cityId = $("#city_id").val();
  		  var cityName = $("#city_name").val();
  		  if(cityId==""&&cityName!=""){
  			 cityId="-10000";
  		  }
  		  dynamicDto = {
  	  				beginDate:begin_end_date[0].trim(),
  	  				endDate:begin_end_date[1].trim(),
  	  				cityId:cityId,
  	  		  		employeeId:employeeId,
  	  		  		target:target,
  	  		  		searchstr:"city"
  	  			}
  	   }else if(target==1){//城市
 	    	 dynamicDto = {
 	    		beginDate:begin_end_date[0].trim(),
 	 	  		endDate:begin_end_date[1].trim(),
   				cityId:initCity,
   		  		employeeId:employeeId,
   		  		target:target,
   		  		searchstr:"city"
   			}
 	    }
	   
	    doManager('dynamicManager','exportUserMemberInfo',[dynamicDto],function(data){
          if(data.result){
          	   var result= JSON.parse(data.data);
	           if(result.status=='success'){
	        	   window.location.href=result.data;
	           }else if(result.status=='null'){
	        	   crm_alert(0,"请先确认是否有符合条件的数据，重新请求！");
	        	   $("#process_div").hide();
        	       $("#process_div_pic").hide();
	        	   return;
	           }else{
	        	   crm_alert(5,"请稍后重新请求！");
	        	   $("#process_div").hide();
        	       $("#process_div_pic").hide();
	           }
          
          }else{
       	   crm_alert(5,"请稍后重新请求！");
          }
         $("#process_div").hide();
    	 $("#process_div_pic").hide();
      }); 
    }


//导出上第二步
function export_customer(){
    //注册时间
    var sdate = $("#last_date").val();
    var begin_end_date=["",""];
    if(sdate!=""){
        begin_end_date = sdate.split("-");
    }
    $("#process_div").show();
    $("#process_div_pic").show();

    var number_str = $("#store_id_try").val();
    var storeName = $("#store_name_try").val();

    if(number_str==""&&storeName!=""){
        number_str=-10000;
    }
    var dynamicDto=null;
    if(target==0){//总部
        var cityId = $("#city_id_try").val();
        var cityName = $("#city_name_try").val();
        if(cityId==""&&cityName!=""){
            cityId="-10000";
        }
        dynamicDto = {
            beginDate:begin_end_date[0].trim(),
            endDate:begin_end_date[1].trim(),
            storeNumer:number_str,
            cityId:cityId,
            employeeId:employeeId,
            target:target,
            storeId:number_str,
            searchstr:"try_member"
        }
    }else if(target==1){//城市
        dynamicDto = {
            beginDate:begin_end_date[0].trim(),
            endDate:begin_end_date[1].trim(),
            storeNumer:number_str,
            cityId:initCity,
            employeeId:employeeId,
            target:target,
            storeId:number_str,
            searchstr:"try_member"
        }
    }else if(target==2){//店长
        dynamicDto = {
            beginDate:begin_end_date[0].trim(),
            endDate:begin_end_date[1].trim(),
            storeNumer:number_str,
            employeeNo:employeeId,
            storeId:storeId,
            target:target,
            searchstr:"try_member"
        }
    }

    doManager('dynamicManager','exportUserMemberInfo',[dynamicDto],function(data){
        if(data.result){
            var result= JSON.parse(data.data);
            if(result.status=='success'){
                window.location.href=result.data;
            }else if(result.status=='null'){
                crm_alert(0,"请先确认是否有符合条件的数据，重新请求！");
                $("#process_div").hide();
                $("#process_div_pic").hide();
                return;
            }else{
                crm_alert(5,"请稍后重新请求！");
                $("#process_div").hide();
                $("#process_div_pic").hide();
            }

        }else{
            crm_alert(5,"请稍后重新请求！");
        }
        $("#process_div").hide();
        $("#process_div_pic").hide();
    });
}
 
function resetSerachParam(){
	 $("#auto_store").empty();
	if(target==0){//总部
		if(fromBar != "1" && fromBar != "2"){
			$("#city_id_tradetype").val("");
			$("#city_name_tradetype").val("");
		}
		$("#store_id_tradetype").val("");
  		$("#store_name_tradetype").val("");
    	
    
  	  }else if(target==1){//城市级别
    	
  		$("#store_id_tradetype").val("");
  		$("#store_name_tradetype").val("");
  		  
  	  }else if(target==2){//店长
  		
  	  }
	var nowDate = new Date();
	var month = nowDate.getMonth()+1;
    var date = nowDate.getDate();
    timeStr = nowDate.getFullYear() + '/' + (month < 10 ? '0' + month : '' + month) + '/' + (date < 10 ? '0' + date : '' + date);
    nowDate.setDate(nowDate.getDate()+parseInt(-1));
    var startDateStr = nowDate.getFullYear() + '/' + (month < 10 ? '0' + month : '' + month) + '/01'; 
	$("#searchTime").val(startDateStr +"-"+ timeStr);
	$("#data_choice").html("默认时期");

}

function resetSerachParamTry(){
    $("#auto_store_try").empty();
    if(target==0){//总部
        if(fromBar != "1" && fromBar != "3"){
            $("#city_id_try").val("");
            $("#city_name_try").val("");
        }
        $("#store_id_try").val("");
        $("#store_name_try").val("");


    }else if(target==1){//城市级别

        $("#store_id_try").val("");
        $("#store_name_try").val("");

    }else if(target==2){//店长

    }
    var nowDate = new Date();
    var month = nowDate.getMonth()+1;
    var date = nowDate.getDate();
    timeStr = nowDate.getFullYear() + '/' + (month < 10 ? '0' + month : '' + month) + '/' + (date < 10 ? '0' + date : '' + date);
    nowDate.setDate(nowDate.getDate()+parseInt(-1));
    var startDateStr = nowDate.getFullYear() + '/' + (month < 10 ? '0' + month : '' + month) + '/01';
    $("#last_date").val(startDateStr +"-"+ timeStr);
    $("#data_choice").html("默认时期");

}

function customer_member(){
    var URL="big_member_view.html?"+"t="+encode64(target);
    window.open(URL,"big_member");
}
</script>

</body>
</html>