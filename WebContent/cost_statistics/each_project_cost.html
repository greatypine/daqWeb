<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>成本控制</title>
    <link rel="shortcut icon" type="image/x-icon" href="../icon.png" />
    <link rel="stylesheet" type="text/css" href="plugins/fixed-columns/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="plugins/fixed-columns/css/bootstrap-table.css">
    <link rel="stylesheet" type="text/css" href="plugins/fixed-columns/css/bootstrap-table-fixed-columns.css">
    <link href="../startbootstrap/bower_components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../crm/plugins/date-new/css/jquery-ui-1.9.2.custom.css" type="text/css">
    <link href="../startbootstrap/dist/css/sb-admin-2.css" rel="stylesheet">
    <link href="../startbootstrap/bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="../scripts/css/auto.css" rel="stylesheet">


    <!-- jQuery 2.2.0 -->
    <script src="../crm/plugins/jQuery/jQuery-2.2.0.min.js"></script>
    <script type="text/javascript" src="plugins/fixed-columns/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="plugins/fixed-columns/js/bootstrap-table.js"></script>
    <script type="text/javascript" src="plugins/fixed-columns/js/bootstrap-table-fixed-columns.js"></script>
    <script type="text/javascript" src="../scripts/bidLibjsjquery3.0.js"></script>
    <script src="../crm/dist/js/headquarters/conversion_utils.js"></script>
    <script src="../crm/plugins/date-new/js/jquery-ui-1.9.2.custom.js" type = "text/javascript"></script>


    <script type="text/javascript">
        var observe_month=decode64(getUrlParamByKey("om"));
        var add_edit=decode64(getUrlParamByKey("t"));
        var store_name=decode64(getUrlParamByKey("sn"));
        var store_id=decode64(getUrlParamByKey("si"));
        var observe_question_number = 0;
        var colorStyleArray = ["trbg1","trbg2","trbg3","trbg4","trbg5","trbg6","trbg7","trbg8","trbg9","trbg10","trbg11","trbg12"];

        function latetime(){
            var today = new Date();
            var now = today.getDate();
            var year = today.getYear();
            if (year < 2000) year += 1900;var month = today.getMonth();
            var monarr = new Array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
            if (((year % 4 == 0) && (year % 100 != 0)) || (year % 400 == 0)) monarr[1] = "29";
            var late = monarr[month]-now;
            return late;
        }

        var month_array = ["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"];
        $(function(){
            getCostLabor();//获取人工成本
        });




        /**
         * 获取人工成本
         * **/
        function getCostLabor(){

            var storeNo=null;
            var storeName=null;
            var year = 2018;
            var month = 6;

            doManager('costStatisticsManager','queryCostLabor',[storeNo,storeName,year,month],function (data) {
                if(data.result){
                    var costLabor = JSON.parse(data.data).labor;
                    var $table = $('#cost_labor');
                    buildLaborTable($table,costLabor);
                }
            },false);

        }

        function buildLaborTable($el,data) {
            var columns = [];

            var firstRowTitle=[];
            var secondTitle=[];

            firstRowTitle.push({
                title:"序号",
                rowspan: 2,
                valign: "middle",
                halign: "center",
                formatter: function (value, row, index){
                    return  index;
                }
            });

            firstRowTitle.push({
                field: 'storeNo',
                title:"门店编号",
                rowspan: 2,
                colspan:1,
                valign: "middle",
                halign: "center"
            });

            firstRowTitle.push({
                field: 'storeName',
                title:"门店名称",
                rowspan: 2,
                colspan:1,
                valign: "middle",
                halign: "center"
            });



            for (var i = 0; i < 12; i++) {
                firstRowTitle.push({
                    title:i+1+"月",
                    valign: "middle",
                    halign: "center",
                    colspan:4,
                    rowspan:1

                });
            }
            firstRowTitle.push({
                field: 'uniform_charge',
                title:"工服年费",
                rowspan: 2,
                colspan:1,
                valign: "middle",
                halign: "center"
            });
            columns.push(firstRowTitle);

            for(var j=0;j<12;j++){
                secondTitle.push({
                    filed:"emolument",
                    title:"员工薪酬",
                    valign: "middle",
                    halign: "center",
                    colspan:1,
                    rowspan:1
                });

                secondTitle.push({
                    filed:"uniform_amortize",
                    title:"工服摊销",
                    valign: "middle",
                    halign: "center",
                    colspan:1,
                    rowspan:1
                });
                secondTitle.push({
                    filed:"accommodation",
                    title:"住宿星店房租",
                    valign: "middle",
                    halign: "center",
                    colspan:1,
                    rowspan:1
                });
                secondTitle.push({
                    filed:"subtotal",
                    title:"小计（元）",
                    valign: "middle",
                    halign: "center",
                    colspan:1,
                    rowspan:1
                });

            }

            columns.push(secondTitle);

            $el.bootstrapTable('destroy').bootstrapTable({
                columns: columns,
                data: data,
                height:500,
                showColumns : false,
                fixedColumns: true,
                fixedNumber:3,
                search:false,
                toolbar:false
            });
        }
    </script>
</head>
<style type="text/css">

    p{
        margin-top: 10px;
        margin-bottom: 10px;
    }
    table input,table select{border:1px solid #ccc; border-radius:3px; line-height: 30px; height: 30px; width:200px;}
    .panel-heading .but{float:right; text-align: center;}
    .but input {
        background-color: transparent;
        border: 1px solid #fff;
        border-radius: 3px;
        padding: 0 13px;
        margin-right: 30px;}
    .ui-dialog .ui-dialog-titlebar-close span {
        display: none;
    }
    /*table th,table td{border: 1px solid #e1e1e1; line-height: 30px; padding: 0 5px;word-wrap:break-word ;}*/
    /*table span{color: #f00;}*/
    /*table .trbg1{background-color: #f2d4d4;}*/
    /*table .trbg2{background-color: #cff1aa;}*/
    /*table .trbg3{background-color: #e2d7f0;}*/
    /*table .trbg4{background-color: #f4f45a;}*/
    /*table .trbg5{background-color: #3ed783;}*/
    /*table .trbg6{background-color: #00b0f0;}*/
    /*table .trbg7{background-color: #c4bd97;}*/
    /*table .trbg8{background-color: #f00;}*/
    /*table .trbg9{background-color: #ffc000;}*/
    /*table .trbg10{background-color: #bfbfbf;}*/
    /*table .trbg11{background-color: #92cddc;}*/
    /*table .trbg12{background-color: #ff99ff;}*/

    .content-wrapper{background: #fff;}
    .nav-tabs-custom,.nav-tabs-custom > .tab-content{background: transparent;}
    .nav-tabs-custom > .nav-tabs > li > a{font-size: 14px; padding: 8px 15px;}
    .nav-tabs-custom > .nav-tabs > li > a:hover{color: #3a90cb;}
    .nav-tabs-custom > .nav-tabs > li.active > a,.nav-tabs-custom > .nav-tabs > li.active > a:hover{background: #3a90cb; color: #fff;font-weight: bold; cursor: pointer;border-top-right-radius: 3px; border-top-left-radius: 3px; border-top: 2px solid #3a90cb; border-left: 1px solid #3a90cb; border-right:1px solid #3a90cb;}
    .nav-tabs-custom > .nav-tabs > li:first-of-type.active > a{border-left: 1px solid #3a90cb;}
    .nav-tabs-custom > .nav-tabs{border-bottom: 1px solid #3a90cb; margin: 5px 0; }
    .nav-tabs-custom > .nav-tabs > li{margin-bottom: -1px;}

</style>
<body style="height: 100%">
<div class="panel panel-primary" style="margin: 10px 5px 0 5px">
    <div class="panel-heading">成本控制
        <span class="but">
			<input name="" id="saveclick" type="submit" onclick="yanzhen();" value="保存">
			<input name="" type="button" onclick="javascript:history.go(-1);" value="返回">
		</span>
    </div>
    <div class="panel-body" id="temp1">
        <div class="nav-tabs-custom">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#tab_1" data-toggle="tab">人工成本</a></li>
                <li><a href="#tab_2" data-toggle="tab">租金成本</a></li>
                <li><a href="#tab_3" data-toggle="tab">装修摊销</a></li>
            </ul>
            <div class="tab-content no-padding">
                <div class="tab-pane active" id="tab_1">
                    <form action="" method="post" class="pmsForm">
                        <table width="100%">
                            <tr>
                                <td width="20%">
                                    <p>门店编号：</p>
                                    <p><input type="text"   id="storeNo_s"></p>
                                </td>
                                <td width="20%">
                                    <p>门店名称：</p>
                                    <p><input type="text" id="storeName_s"/></p>
                                </td>
                                <td width="20%">
                                    <p class="read">日期：</p>
                                    <p class="read"><input type="text"   maxlength="12"  id="date_s"/></p>
                                </td>

                            </tr>
                        </table>
                        <table id="cost_labor" ></table>


                    </form>
                </div>
                <!-- /.tab-pane -->
                <div class="tab-pane" id="tab_2">
                    <form action="" method="post" class="pmsForm">
                        <table width="100%">
                            <tr>
                                <td width="20%">
                                    <p>明查月份1：</p>
                                    <p><input type="text" readonly style="background:#CCCCCC" id="observe_month" name="observe_month"></p>
                                </td>
                                <td width="20%">
                                    <p>检查人：<span style="color: red">*</span></p>
                                    <p><input type="text" name="observe_person" id="observe_person"/></p>
                                </td>
                                <td width="20%">
                                    <p class="read">进店日期：<span style="color: red">*</span></p>
                                    <p class="read"><input type="text" readonly  maxlength="12" name="observe_date" id="observe_date"/></p>
                                </td>
                                <td width="20%">
                                    <p class="read">扣分合计：</p>
                                    <p class="read"><input type="text" readonly style="background:#CCCCCC"  maxlength="12" name="buckle_points_combined" id="buckle_points_combined"/></p>
                                </td>
                                <td width="20%">
                                    <p class="read">本次明查得分：</p>
                                    <p class="read"><input type="text" readonly style="background:#CCCCCC" maxlength="12" name="points_combined" id="points_combined"/></p>
                                </td>
                            </tr>
                        </table>
                        <table class="easyui-datagrid" title="Frozen Columns in DataGrid" style="width:700px;height:250px">
                            <thead data-options="frozen:true">
                            <tr>
                                <th data-options="field:'itemid',width:100">Item ID</th>
                                <th data-options="field:'productid',width:120">Product</th>
                            </tr>
                            </thead>
                            <thead>
                            <tr>
                                <th data-options="field:'listprice',width:90,align:'right'">List Price</th>
                                <th data-options="field:'unitcost',width:90,align:'right'">Unit Cost</th>
                                <th data-options="field:'attr1',width:250">Attribute</th>
                                <th data-options="field:'status',width:60,align:'center'">Status</th>
                            </tr>
                            </thead>
                        </table>
                    </form>
                </div>
                <!-- /.tab-pane -->
                <div class="tab-pane" id="tab_3">
                    <form action="" method="post" class="pmsForm">
                        <table width="100%">
                            <tr>
                                <td width="20%">
                                    <p>明查月份3：</p>
                                    <p><input type="text" readonly style="background:#CCCCCC" id="observe_month" name="observe_month"></p>
                                </td>
                                <td width="20%">
                                    <p>检查人：<span style="color: red">*</span></p>
                                    <p><input type="text" name="observe_person" id="observe_person"/></p>
                                </td>
                                <td width="20%">
                                    <p class="read">进店日期：<span style="color: red">*</span></p>
                                    <p class="read"><input type="text" readonly  maxlength="12" name="observe_date" id="observe_date"/></p>
                                </td>
                                <td width="20%">
                                    <p class="read">扣分合计：</p>
                                    <p class="read"><input type="text" readonly style="background:#CCCCCC"  maxlength="12" name="buckle_points_combined" id="buckle_points_combined"/></p>
                                </td>
                                <td width="20%">
                                    <p class="read">本次明查得分：</p>
                                    <p class="read"><input type="text" readonly style="background:#CCCCCC" maxlength="12" name="points_combined" id="points_combined"/></p>
                                </td>
                            </tr>
                        </table>
                        <table id="observebaseInfo" cellpadding="0" cellspacing="0" border="1" width="100%" style="border: 1px solid #e1e1e1;">
                            <col width="5%" align="center">
                            <col width="40%">
                            <col width="20%">
                            <col width="15%">
                            <col width="20%">
                            <tr>
                                <th colspan="2" ><span id="store_name"></span>明查检查表</th>
                                <th colspan="3"><span id="observe_month_info"></span>月<br>检查重点：</th>
                            </tr>
                            <tr>
                                <th width="5%">模块</th>
                                <th>明查执行</th>
                                <th>扣分情况说明</th>
                                <th>扣分</th>
                                <th>被扣分人员姓名、工号、扣分数</th>
                            </tr>

                        </table>
                    </form>
                </div>
                <!-- /.tab-pane -->
            </div>
            <!-- /.tab-content -->
        </div>

    </div>
</div>
</body>
</html>